<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Maps Test - Fleet Management</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        #map {
            width: 100%;
            height: 600px;
            border: 2px solid #333;
            border-radius: 8px;
            margin: 20px 0;
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            background: #2a2a2a;
        }
        .success { border-left: 4px solid #4CAF50; }
        .error { border-left: 4px solid #f44336; }
        .info { border-left: 4px solid #2196F3; }
        h1 { color: #4CAF50; }
        pre { background: #2a2a2a; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üó∫Ô∏è Google Maps Integration Test</h1>

    <div id="status-container">
        <div class="status info">
            <strong>Status:</strong> Loading Google Maps API...
        </div>
    </div>

    <div id="map"></div>

    <div class="status info">
        <strong>Test Information:</strong>
        <ul>
            <li>API Key: AIzaSyCYed_P5MboiprRaPRzSSkYZpMUBG3g61M</li>
            <li>Center: Tallahassee, FL (30.4383, -84.2807)</li>
            <li>Expected: Interactive map with markers</li>
        </ul>
    </div>

    <script>
        const API_KEY = 'AIzaSyCYed_P5MboiprRaPRzSSkYZpMUBG3g61M';
        const statusContainer = document.getElementById('status-container');

        function addStatus(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<strong>${type === 'success' ? '‚úì' : type === 'error' ? '‚úó' : '‚Ñπ'}</strong> ${message}`;
            statusContainer.appendChild(div);
            console.log(`[${type.toUpperCase()}]`, message);
        }

        // Load Google Maps API
        function loadGoogleMapsAPI() {
            return new Promise((resolve, reject) => {
                if (window.google && window.google.maps) {
                    addStatus('Google Maps API already loaded', 'success');
                    resolve();
                    return;
                }

                const script = document.createElement('script');
                script.src = `https://maps.googleapis.com/maps/api/js?key=${API_KEY}&libraries=places,geometry`;
                script.async = true;
                script.defer = true;

                script.onload = () => {
                    addStatus('Google Maps API loaded successfully!', 'success');
                    resolve();
                };

                script.onerror = (error) => {
                    addStatus(`Failed to load Google Maps API: ${error}`, 'error');
                    reject(error);
                };

                document.head.appendChild(script);
                addStatus('Loading Google Maps JavaScript API...', 'info');
            });
        }

        // Initialize map
        async function initMap() {
            try {
                await loadGoogleMapsAPI();

                const mapElement = document.getElementById('map');

                // Tallahassee, FL coordinates
                const tallahassee = { lat: 30.4383, lng: -84.2807 };

                // Create map
                const map = new google.maps.Map(mapElement, {
                    center: tallahassee,
                    zoom: 12,
                    mapTypeId: 'roadmap',
                    styles: [
                        {
                            "elementType": "geometry",
                            "stylers": [{ "color": "#212121" }]
                        },
                        {
                            "elementType": "labels.icon",
                            "stylers": [{ "visibility": "off" }]
                        },
                        {
                            "elementType": "labels.text.fill",
                            "stylers": [{ "color": "#757575" }]
                        },
                        {
                            "elementType": "labels.text.stroke",
                            "stylers": [{ "color": "#212121" }]
                        }
                    ]
                });

                addStatus('Map initialized successfully!', 'success');

                // Add sample vehicle markers
                const vehicles = [
                    { lat: 30.4383, lng: -84.2807, name: 'Vehicle 1', status: 'active' },
                    { lat: 30.4500, lng: -84.2900, name: 'Vehicle 2', status: 'active' },
                    { lat: 30.4300, lng: -84.2700, name: 'Vehicle 3', status: 'maintenance' },
                    { lat: 30.4450, lng: -84.2650, name: 'Vehicle 4', status: 'active' }
                ];

                vehicles.forEach(vehicle => {
                    const marker = new google.maps.Marker({
                        position: { lat: vehicle.lat, lng: vehicle.lng },
                        map: map,
                        title: vehicle.name,
                        icon: {
                            path: google.maps.SymbolPath.CIRCLE,
                            scale: 8,
                            fillColor: vehicle.status === 'active' ? '#4CAF50' : '#FFC107',
                            fillOpacity: 1,
                            strokeColor: '#fff',
                            strokeWeight: 2
                        }
                    });

                    const infoWindow = new google.maps.InfoWindow({
                        content: `
                            <div style="color: #000; padding: 5px;">
                                <strong>${vehicle.name}</strong><br>
                                Status: ${vehicle.status}<br>
                                Location: ${vehicle.lat.toFixed(4)}, ${vehicle.lng.toFixed(4)}
                            </div>
                        `
                    });

                    marker.addListener('click', () => {
                        infoWindow.open(map, marker);
                    });
                });

                addStatus(`Added ${vehicles.length} vehicle markers to map`, 'success');
                addStatus('‚úì Google Maps is fully functional!', 'success');

            } catch (error) {
                addStatus(`Error initializing map: ${error.message}`, 'error');
                console.error('Map initialization error:', error);
            }
        }

        // Start initialization
        addStatus('Starting Google Maps test...', 'info');
        initMap();
    </script>
</body>
</html>
