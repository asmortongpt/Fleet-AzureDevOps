# ===========================================
# Fleet Management System - Staging Environment
# Domain: fleet-staging.capitaltechalliance.com
# ===========================================

# ------------------
# Frontend (Vite)
# ------------------
VITE_API_URL=https://fleet-staging.capitaltechalliance.com
VITE_ENVIRONMENT=staging

# Azure AD Authentication
VITE_AZURE_AD_CLIENT_ID=${AZURE_AD_CLIENT_ID}
VITE_AZURE_AD_TENANT_ID=${AZURE_AD_TENANT_ID}
VITE_AZURE_AD_REDIRECT_URI=https://fleet-staging.capitaltechalliance.com/auth/callback

# Azure Maps (Frontend)
VITE_AZURE_MAPS_SUBSCRIPTION_KEY=${AZURE_MAPS_KEY}

# Feature Flags
VITE_ENABLE_AI_ASSISTANT=true
VITE_ENABLE_TEAMS_INTEGRATION=true
VITE_ENABLE_EMAIL_CENTER=true
VITE_ENABLE_DARK_MODE=true
VITE_ENABLE_DISPATCH_CONSOLE=true
VITE_ENABLE_TRAFFIC_CAMERAS=true

# ------------------
# Backend API - Server Configuration
# ------------------

# Server
PORT=8080
NODE_ENV=staging
API_BASE_URL=https://fleet-staging-api.capitaltechalliance.com

# Database - PostgreSQL (Staging)
DATABASE_TYPE=postgresql
DATABASE_HOST=${DB_HOST:-fleet-staging-db.postgres.database.azure.com}
DATABASE_PORT=5432
DATABASE_NAME=fleet_staging
DATABASE_USER=fleetadmin
DATABASE_PASSWORD=${DB_PASSWORD}
DATABASE_SSL=true
DATABASE_MAX_CONNECTIONS=20
DATABASE_CONNECTION_TIMEOUT=30000

# ------------------
# Security & Authentication
# ------------------

# JWT Tokens (Generate with: openssl rand -hex 64)
JWT_SECRET=${JWT_SECRET}
JWT_REFRESH_SECRET=${JWT_REFRESH_SECRET}
JWT_EXPIRES_IN=8h
JWT_REFRESH_EXPIRES_IN=7d

# Data Encryption
ENCRYPTION_KEY=${ENCRYPTION_KEY}
ENCRYPTION_ALGORITHM=aes-256-gcm

# Session Management
SESSION_SECRET=${SESSION_SECRET}
SESSION_MAX_AGE=86400000

# API Key Security
API_KEY_SALT=${API_KEY_SALT}

# CORS - Staging domains
CORS_ORIGIN=https://fleet-staging.capitaltechalliance.com,https://fleet-staging-api.capitaltechalliance.com
CORS_CREDENTIALS=true

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ------------------
# Azure Services
# ------------------

# Azure OpenAI Service
AZURE_OPENAI_ENDPOINT=${AZURE_OPENAI_ENDPOINT}
AZURE_OPENAI_KEY=${AZURE_OPENAI_KEY}
AZURE_OPENAI_DEPLOYMENT=gpt-4
AZURE_OPENAI_API_VERSION=2024-08-01-preview

# Alternative: OpenAI Direct
OPENAI_API_KEY=${OPENAI_API_KEY}

# Microsoft Graph API (Teams & Outlook)
MS_GRAPH_CLIENT_ID=${MS_GRAPH_CLIENT_ID}
MS_GRAPH_CLIENT_SECRET=${MS_GRAPH_CLIENT_SECRET}
MS_GRAPH_TENANT_ID=${MS_GRAPH_TENANT_ID}
MS_GRAPH_SCOPE=https://graph.microsoft.com/.default

# Azure Storage (File uploads)
AZURE_STORAGE_CONNECTION_STRING=${AZURE_STORAGE_CONNECTION_STRING}
AZURE_STORAGE_CONTAINER_NAME=fleet-staging-files
AZURE_STORAGE_DOCUMENT_CONTAINER=fleet-staging-documents

# Azure Maps
AZURE_MAPS_SUBSCRIPTION_KEY=${AZURE_MAPS_KEY}

# Azure Key Vault
AZURE_KEY_VAULT_URI=${AZURE_KEY_VAULT_URI}

# Application Insights
APPLICATION_INSIGHTS_CONNECTION_STRING=${APP_INSIGHTS_CONNECTION_STRING}

# ------------------
# Email & SMS Services
# ------------------

# SendGrid
SENDGRID_API_KEY=${SENDGRID_API_KEY}
SENDGRID_FROM_EMAIL=noreply-staging@capitaltechalliance.com
SENDGRID_FROM_NAME=Fleet Management Staging

# SMTP (Alternative)
SMTP_HOST=smtp.office365.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=${SMTP_USER}
SMTP_PASSWORD=${SMTP_PASSWORD}
SMTP_FROM=noreply-staging@capitaltechalliance.com

# Twilio
TWILIO_ACCOUNT_SID=${TWILIO_ACCOUNT_SID}
TWILIO_AUTH_TOKEN=${TWILIO_AUTH_TOKEN}
TWILIO_PHONE_NUMBER=${TWILIO_PHONE_NUMBER}

# ------------------
# Mobile Push Notifications
# ------------------

# Firebase (Android)
FIREBASE_SERVICE_ACCOUNT=${FIREBASE_SERVICE_ACCOUNT}

# APNS (iOS)
APNS_KEY_PATH=${APNS_KEY_PATH}
APNS_KEY_ID=${APNS_KEY_ID}
APNS_TEAM_ID=${APNS_TEAM_ID}
APNS_BUNDLE_ID=com.capitaltechalliance.fleet.staging
APNS_PRODUCTION=false

# ------------------
# Document Management & RAG
# ------------------

DOCUMENT_UPLOAD_DIR=/tmp/uploads/documents
DOCUMENT_MAX_SIZE_MB=50

OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_CHAT_MODEL=gpt-4o-mini

# ------------------
# File Storage & Reports
# ------------------

REPORTS_OUTPUT_DIR=/tmp/reports
REPORTS_RETENTION_DAYS=90

ENABLE_REPORT_SCHEDULER=true
REPORT_SCHEDULER_CRON=0 * * * *

# ------------------
# Job Schedulers
# ------------------

ALERT_CHECKER_INTERVAL_MINUTES=5
REPORT_SCHEDULER_INTERVAL_MINUTES=60
PUSH_NOTIFICATION_SCHEDULER_INTERVAL_MINUTES=1
ML_RETRAINING_CRON=0 2 * * *

# ------------------
# Logging & Monitoring
# ------------------

DEBUG=fleet:*
LOG_LEVEL=debug
LOG_FORMAT=json
LOG_OUTPUT=/var/log/fleet/app.log

# Error Tracking (Sentry)
SENTRY_DSN=${SENTRY_DSN}
SENTRY_ENVIRONMENT=staging
SENTRY_TRACE_SAMPLE_RATE=1.0

# ------------------
# Performance & Caching
# ------------------

# Redis (if available)
REDIS_HOST=${REDIS_HOST}
REDIS_PORT=6380
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_TLS=true

CACHE_TTL=3600

# ------------------
# Compliance & Security
# ------------------

ENABLE_HELMET=true
ENABLE_CSRF_PROTECTION=true

COOKIE_SECURE=true
COOKIE_HTTP_ONLY=true
COOKIE_SAME_SITE=strict

DATA_RETENTION_DAYS=365
AUDIT_LOG_RETENTION_DAYS=2555

# ------------------
# Feature Flags (Backend)
# ------------------

ENABLE_AI_FEATURES=true
ENABLE_ML_PREDICTIONS=true
ENABLE_RAG_SYSTEM=true
ENABLE_LANGCHAIN_ORCHESTRATION=true
ENABLE_MCP_SERVERS=true

# ------------------
# AI Provider Configuration
# ------------------

AI_PRIMARY_PROVIDER=openai
AI_CHAT_PROVIDER=openai
AI_EMBEDDINGS_PROVIDER=openai
AI_VISION_PROVIDER=openai
AI_FUNCTIONS_PROVIDER=openai

AI_COST_OPTIMIZATION=true
AI_PREFER_CHEAPER=true
AI_MAX_COST_PER_REQUEST=1.0

AI_MONITORING=true
AI_LOG_REQUESTS=true
AI_LOG_RESPONSES=false

# ===========================================
# STAGING NOTES:
# 1. This is for staging/testing environment
# 2. Some security controls may be relaxed for testing
# 3. Full logging enabled for debugging
# 4. Use real API keys but test data
# ===========================================
