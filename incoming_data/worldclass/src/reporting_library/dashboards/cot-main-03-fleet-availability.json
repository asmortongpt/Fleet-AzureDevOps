{
  "id": "cot-main-03",
  "title": "Fleet Availability",
  "domain": "exec",
  "category": "city_tallahassee_main",
  "description": "Availability, downtime, and percentage for Fleet/StarMetro vs Industry Standard",
  "datasource": {"type": "sqlView", "view": "vw_fleet_availability", "parameters": {"date_start": "{{dateRange.start}}", "date_end": "{{dateRange.end}}", "business_area": "{{businessArea}}"}},
  "filters": [
    {"name": "dateRange", "type": "dateRange", "default": "current_month", "required": true},
    {"name": "businessArea", "type": "select", "values": ["Fleet", "StarMetro", "All"], "default": "All"}
  ],
  "visuals": [
    {
      "id": "kpis",
      "type": "kpiTiles",
      "title": "Availability Metrics",
      "measures": [
        {"id": "availability_pct", "label": "Availability %", "format": "percent", "expression": "available_hours/(available_hours + downtime_hours)"},
        {"id": "industry_std", "label": "Industry Std", "format": "percent", "value": 0.92},
        {"id": "variance", "label": "Variance", "format": "percent", "expression": "availability_pct - 0.92"},
        {"id": "total_downtime", "label": "Downtime Hours", "format": "decimal", "aggregation": "sum", "field": "downtime_hours"}
      ],
      "layout": {"x": 0, "y": 0, "w": 12, "h": 2}
    },
    {
      "id": "availability_comparison",
      "type": "groupedBar",
      "title": "Fleet vs StarMetro Availability",
      "encoding": {
        "x": {"field": "business_area", "type": "nominal"},
        "y": {"field": "availability_pct", "type": "quantitative"},
        "color": {"field": "business_area", "type": "nominal"}
      },
      "layout": {"x": 0, "y": 2, "w": 6, "h": 4},
      "interactions": {"drilldown": true}
    },
    {
      "id": "downtime_trend",
      "type": "line",
      "title": "Downtime Trend Over Time",
      "encoding": {
        "x": {"field": "date", "type": "temporal"},
        "y": {"field": "downtime_hours", "type": "quantitative", "aggregate": "sum"},
        "color": {"field": "business_area", "type": "nominal"}
      },
      "layout": {"x": 6, "y": 2, "w": 6, "h": 4}
    }
  ],
  "exports": [{"format": "csv"}, {"format": "xlsx"}, {"format": "pdf"}],
  "security": {"rowLevel": [{"role": "Admin", "rule": "TRUE"}]}
}
