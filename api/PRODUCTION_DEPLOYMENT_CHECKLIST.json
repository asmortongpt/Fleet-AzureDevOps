{
    "production_deployment_checklist": {
        "title": "Fleet Application - Production Deployment Checklist",
        "version": "1.0",
        "date": "2026-01-07",
        "prepared_by": "Morton Technology Alliance, LLC"
    },
    "pre_deployment": {
        "security": [
            {
                "id": "SEC-001",
                "task": "Verify all npm vulnerabilities resolved or mitigated",
                "status": "DONE",
                "notes": "3 remaining, all mitigated"
            },
            {
                "id": "SEC-002",
                "task": "Confirm MOCK_HASH bypass removed",
                "status": "DONE",
                "evidence": "Verified in auth.ts"
            },
            {
                "id": "SEC-003",
                "task": "Verify rate limiting enabled",
                "status": "DONE",
                "config": "5 attempts/15min login"
            },
            {
                "id": "SEC-004",
                "task": "Confirm HTTPS enforcement",
                "status": "READY",
                "action": "Set NODE_ENV=production"
            },
            {
                "id": "SEC-005",
                "task": "Verify CORS origins configured",
                "status": "READY",
                "action": "Set CORS_ORIGIN env var"
            },
            {
                "id": "SEC-006",
                "task": "Confirm CSRF protection active",
                "status": "DONE",
                "middleware": "csrf-csrf"
            },
            {
                "id": "SEC-007",
                "task": "Generate production JWT keys",
                "status": "READY",
                "action": "Generate RS256 key pair"
            },
            {
                "id": "SEC-008",
                "task": "Set secure cookie settings",
                "status": "READY",
                "action": "httpOnly, secure, sameSite"
            }
        ],
        "infrastructure": [
            {
                "id": "INF-001",
                "task": "Configure Azure App Service",
                "status": "PENDING"
            },
            {
                "id": "INF-002",
                "task": "Set up Azure PostgreSQL",
                "status": "PENDING"
            },
            {
                "id": "INF-003",
                "task": "Configure Redis Cache",
                "status": "PENDING"
            },
            {
                "id": "INF-004",
                "task": "Set up Azure Blob Storage",
                "status": "PENDING"
            },
            {
                "id": "INF-005",
                "task": "Configure Application Insights",
                "status": "PENDING"
            },
            {
                "id": "INF-006",
                "task": "Set up Sentry for error tracking",
                "status": "PENDING"
            },
            {
                "id": "INF-007",
                "task": "Configure Azure CDN",
                "status": "PENDING"
            },
            {
                "id": "INF-008",
                "task": "Set up Azure Key Vault",
                "status": "PENDING"
            }
        ],
        "database": [
            {
                "id": "DB-001",
                "task": "Run all migrations",
                "status": "PENDING",
                "command": "npm run migrate"
            },
            {
                "id": "DB-002",
                "task": "Seed initial data",
                "status": "PENDING",
                "command": "npm run seed"
            },
            {
                "id": "DB-003",
                "task": "Create admin user",
                "status": "PENDING",
                "script": "create-test-user.ts"
            },
            {
                "id": "DB-004",
                "task": "Verify tenant isolation",
                "status": "DONE",
                "evidence": "RLS policies verified"
            },
            {
                "id": "DB-005",
                "task": "Configure connection pooling",
                "status": "READY",
                "pool_size": 20
            },
            {
                "id": "DB-006",
                "task": "Set up automated backups",
                "status": "PENDING"
            }
        ],
        "testing": [
            {
                "id": "TST-001",
                "task": "Run E2E test suite",
                "status": "DONE",
                "result": "68 passed, 0 failed"
            },
            {
                "id": "TST-002",
                "task": "Run RBAC permutation tests",
                "status": "DONE",
                "result": "8 passed"
            },
            {
                "id": "TST-003",
                "task": "Verify authentication flow",
                "status": "DONE",
                "evidence": "Login test passed"
            },
            {
                "id": "TST-004",
                "task": "Test SSO integration",
                "status": "PENDING"
            },
            {
                "id": "TST-005",
                "task": "Load test API endpoints",
                "status": "PENDING"
            },
            {
                "id": "TST-006",
                "task": "Smoke test in staging",
                "status": "PENDING"
            }
        ]
    },
    "environment_variables": {
        "required": [
            {
                "name": "NODE_ENV",
                "value": "production",
                "description": "Production environment flag"
            },
            {
                "name": "DATABASE_URL",
                "value": "<azure-postgresql-connection>",
                "description": "PostgreSQL connection string"
            },
            {
                "name": "REDIS_URL",
                "value": "<azure-redis-connection>",
                "description": "Redis connection string"
            },
            {
                "name": "JWT_PRIVATE_KEY_PATH",
                "value": "<path-to-private-key>",
                "description": "RSA private key for JWT signing"
            },
            {
                "name": "JWT_PUBLIC_KEY_PATH",
                "value": "<path-to-public-key>",
                "description": "RSA public key for JWT verification"
            },
            {
                "name": "CORS_ORIGIN",
                "value": "https://fleet.mortontech.com",
                "description": "Allowed CORS origins"
            },
            {
                "name": "CSRF_SECRET",
                "value": "<generate-256-bit-secret>",
                "description": "CSRF token secret"
            },
            {
                "name": "SENTRY_DSN",
                "value": "<sentry-dsn>",
                "description": "Sentry error tracking DSN"
            },
            {
                "name": "APPLICATIONINSIGHTS_CONNECTION_STRING",
                "value": "<app-insights-connection>",
                "description": "Azure Application Insights"
            }
        ],
        "optional": [
            {
                "name": "AZURE_AD_CLIENT_ID",
                "value": "<client-id>",
                "description": "Azure AD app registration"
            },
            {
                "name": "AZURE_AD_CLIENT_SECRET",
                "value": "<client-secret>",
                "description": "Azure AD client secret"
            },
            {
                "name": "AZURE_AD_TENANT_ID",
                "value": "<tenant-id>",
                "description": "Azure AD tenant"
            },
            {
                "name": "OPENAI_API_KEY",
                "value": "<api-key>",
                "description": "OpenAI for AI features"
            },
            {
                "name": "GOOGLE_VISION_CREDENTIALS",
                "value": "<path>",
                "description": "OCR service credentials"
            }
        ]
    },
    "deployment_steps": [
        {
            "step": 1,
            "action": "Build frontend",
            "command": "npm run build",
            "location": "frontend root"
        },
        {
            "step": 2,
            "action": "Build API",
            "command": "npm run build",
            "location": "api directory"
        },
        {
            "step": 3,
            "action": "Set environment variables",
            "location": "Azure App Service"
        },
        {
            "step": 4,
            "action": "Deploy API to Azure App Service",
            "method": "GitHub Actions or Azure CLI"
        },
        {
            "step": 5,
            "action": "Deploy frontend to Azure Static Web Apps or CDN",
            "method": "Azure CLI"
        },
        {
            "step": 6,
            "action": "Run database migrations",
            "command": "npm run migrate"
        },
        {
            "step": 7,
            "action": "Verify health endpoint",
            "url": "https://api.fleet.mortontech.com/health"
        },
        {
            "step": 8,
            "action": "Smoke test login flow",
            "location": "Production URL"
        },
        {
            "step": 9,
            "action": "Verify SSO integration",
            "test": "Azure AD login"
        },
        {
            "step": 10,
            "action": "Monitor for errors",
            "tool": "Sentry + Application Insights"
        }
    ],
    "post_deployment": [
        {
            "task": "Verify all health checks passing",
            "frequency": "Immediate"
        },
        {
            "task": "Monitor error rates in Sentry",
            "frequency": "Hourly for 24h"
        },
        {
            "task": "Check API response times",
            "frequency": "Hourly for 24h"
        },
        {
            "task": "Verify audit logging working",
            "frequency": "Immediate"
        },
        {
            "task": "Test critical user flows",
            "frequency": "Immediate"
        },
        {
            "task": "Notify stakeholders of go-live",
            "frequency": "Once"
        }
    ],
    "rollback_plan": {
        "trigger": "Error rate > 5% or critical functionality failure",
        "steps": [
            "Revert to previous deployment in Azure App Service",
            "Restore database from backup if schema changes caused issues",
            "Notify stakeholders of rollback",
            "Investigate root cause before re-deploy"
        ]
    }
}