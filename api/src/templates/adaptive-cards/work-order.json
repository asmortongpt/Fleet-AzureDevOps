{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.5",
  "body": [
    {
      "type": "Container",
      "style": "emphasis",
      "items": [
        {
          "type": "ColumnSet",
          "columns": [
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "Image",
                  "url": "https://img.icons8.com/fluency/96/work.png",
                  "size": "medium"
                }
              ]
            },
            {
              "type": "Column",
              "width": "stretch",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "Work Order Assignment",
                  "weight": "bolder",
                  "size": "large"
                },
                {
                  "type": "TextBlock",
                  "text": "WO-${workOrderNumber}",
                  "weight": "bolder",
                  "color": "accent",
                  "spacing": "none"
                }
              ]
            },
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "${status}",
                  "weight": "bolder",
                  "color": "${statusColor}",
                  "horizontalAlignment": "right"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "medium",
      "items": [
        {
          "type": "FactSet",
          "facts": [
            {
              "title": "Assigned To:",
              "value": "${assignedTo}"
            },
            {
              "title": "Vehicle:",
              "value": "${vehicleNumber} - ${vehicleMake} ${vehicleModel}"
            },
            {
              "title": "Work Type:",
              "value": "${workType}"
            },
            {
              "title": "Priority:",
              "value": "${priority}"
            },
            {
              "title": "Due Date:",
              "value": "${dueDate}"
            },
            {
              "title": "Location:",
              "value": "${location}"
            },
            {
              "title": "Est. Duration:",
              "value": "${estimatedDuration}"
            }
          ]
        },
        {
          "type": "TextBlock",
          "text": "**Description:**",
          "weight": "bolder",
          "spacing": "medium"
        },
        {
          "type": "TextBlock",
          "text": "${description}",
          "wrap": true,
          "spacing": "small"
        },
        {
          "type": "TextBlock",
          "text": "**Parts Required:**",
          "weight": "bolder",
          "spacing": "medium",
          "isVisible": "${hasPartsRequired}"
        },
        {
          "type": "TextBlock",
          "text": "${partsRequired}",
          "wrap": true,
          "spacing": "small",
          "isVisible": "${hasPartsRequired}"
        }
      ]
    }
  ],
  "actions": [
    {
      "type": "Action.Submit",
      "title": "Accept Work Order",
      "data": {
        "action": "accept_work_order",
        "workOrderId": "${workOrderId}"
      },
      "style": "positive"
    },
    {
      "type": "Action.Submit",
      "title": "Start Work",
      "data": {
        "action": "start_work",
        "workOrderId": "${workOrderId}"
      },
      "style": "positive",
      "isVisible": "${canStartWork}"
    },
    {
      "type": "Action.Submit",
      "title": "Complete Work",
      "data": {
        "action": "complete_work",
        "workOrderId": "${workOrderId}"
      },
      "style": "positive",
      "isVisible": "${canCompleteWork}"
    },
    {
      "type": "Action.OpenUrl",
      "title": "View Details",
      "url": "${workOrderUrl}"
    },
    {
      "type": "Action.ShowCard",
      "title": "Reject",
      "card": {
        "type": "AdaptiveCard",
        "body": [
          {
            "type": "Input.Text",
            "id": "rejectionReason",
            "placeholder": "Please provide a reason for rejection...",
            "isMultiline": true
          }
        ],
        "actions": [
          {
            "type": "Action.Submit",
            "title": "Submit Rejection",
            "data": {
              "action": "reject_work_order",
              "workOrderId": "${workOrderId}"
            },
            "style": "destructive"
          }
        ]
      }
    },
    {
      "type": "Action.ShowCard",
      "title": "Update Progress",
      "card": {
        "type": "AdaptiveCard",
        "body": [
          {
            "type": "Input.ChoiceSet",
            "id": "progressPercentage",
            "label": "Progress",
            "choices": [
              { "title": "25%", "value": "25" },
              { "title": "50%", "value": "50" },
              { "title": "75%", "value": "75" },
              { "title": "90%", "value": "90" }
            ]
          },
          {
            "type": "Input.Text",
            "id": "progressNote",
            "placeholder": "Add progress notes...",
            "isMultiline": true
          }
        ],
        "actions": [
          {
            "type": "Action.Submit",
            "title": "Update",
            "data": {
              "action": "update_progress",
              "workOrderId": "${workOrderId}"
            }
          }
        ]
      }
    }
  ]
}
