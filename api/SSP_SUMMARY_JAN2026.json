{
    "system_security_plan": {
        "title": "Fleet Management System - System Security Plan Summary",
        "version": "1.0",
        "date": "2026-01-07",
        "prepared_by": "Morton Technology Alliance, LLC",
        "authorization_boundary": "Fleet web application and API"
    },
    "system_information": {
        "name": "Fleet Management System",
        "abbreviation": "Fleet",
        "description": "Enterprise fleet management platform for vehicle tracking, maintenance, driver management, and operational analytics",
        "deployment_model": "Cloud (Azure)",
        "service_model": "SaaS",
        "impact_level": "Low/Moderate"
    },
    "security_controls_implementation": {
        "access_control_family": {
            "AC-2": {
                "name": "Account Management",
                "implementation": "PostgreSQL user tables with tenant isolation. Admin-only user management. Automated account deactivation on inactivity.",
                "status": "Implemented"
            },
            "AC-3": {
                "name": "Access Enforcement",
                "implementation": "RBAC middleware (api/src/middleware/rbac.ts) with 9 role levels and 40+ granular permissions.",
                "status": "Implemented"
            },
            "AC-7": {
                "name": "Unsuccessful Logon Attempts",
                "implementation": "Rate limiting (5 attempts/15min) and brute force protection with exponential backoff.",
                "status": "Implemented"
            }
        },
        "audit_family": {
            "AU-2": {
                "name": "Audit Events",
                "implementation": "All CRUD operations logged to audit_logs table with user, action, timestamp, IP, and result.",
                "status": "Implemented"
            },
            "AU-3": {
                "name": "Content of Audit Records",
                "implementation": "Audit records include: tenant_id, user_id, action, resource_type, resource_id, IP, user_agent, result, checksum.",
                "status": "Implemented"
            },
            "AU-9": {
                "name": "Protection of Audit Information",
                "implementation": "SHA-256 checksum for audit record integrity. Audit logs append-only in production.",
                "status": "Implemented"
            }
        },
        "identification_family": {
            "IA-2": {
                "name": "Identification and Authentication",
                "implementation": "JWT RS256 authentication with httpOnly cookies. No localStorage token storage.",
                "status": "Implemented"
            },
            "IA-5": {
                "name": "Authenticator Management",
                "implementation": "PBKDF2 (FIPS) password hashing with bcrypt legacy support. 100,000 iterations.",
                "status": "Implemented"
            },
            "IA-8": {
                "name": "Identification of Non-Org Users",
                "implementation": "Microsoft Azure AD SSO integration for enterprise authentication.",
                "status": "Implemented"
            }
        },
        "system_protection_family": {
            "SC-5": {
                "name": "Denial of Service Protection",
                "implementation": "Global rate limiting (30 req/min production), tiered limiters per endpoint type.",
                "status": "Implemented"
            },
            "SC-7": {
                "name": "Boundary Protection",
                "implementation": "Strict CORS with no wildcards, explicit origin whitelist, HTTPS enforcement.",
                "status": "Implemented"
            },
            "SC-8": {
                "name": "Transmission Confidentiality",
                "implementation": "HTTPS required in production. HSTS header with 1-year max-age.",
                "status": "Implemented"
            },
            "SC-13": {
                "name": "Cryptographic Protection",
                "implementation": "FIPS-approved algorithms: PBKDF2-HMAC-SHA256, RS256 for JWT, SHA-256 for audit.",
                "status": "Implemented"
            }
        },
        "system_integrity_family": {
            "SI-2": {
                "name": "Flaw Remediation",
                "implementation": "npm audit integrated in CI/CD. 87.5% vulnerability reduction achieved.",
                "status": "Implemented"
            },
            "SI-10": {
                "name": "Information Input Validation",
                "implementation": "Zod schema validation on all API endpoints. Parameterized SQL queries.",
                "status": "Implemented"
            }
        }
    },
    "security_architecture": {
        "authentication": {
            "primary": "JWT RS256 with httpOnly cookies",
            "sso": "Microsoft Azure AD",
            "mfa": "Via Azure AD Conditional Access",
            "session": "24-hour access token, 7-day refresh token with rotation"
        },
        "authorization": {
            "model": "Role-Based Access Control (RBAC)",
            "roles": [
                "Admin",
                "FleetManager",
                "MaintenanceManager",
                "Finance",
                "Safety",
                "Inspector",
                "Auditor",
                "Driver",
                "Vendor"
            ],
            "enforcement": [
                "Backend middleware",
                "Frontend permission hooks"
            ],
            "tenant_isolation": "Row-Level Security (RLS) with tenant_id on all queries"
        },
        "data_protection": {
            "encryption_at_rest": "Azure-managed encryption",
            "encryption_in_transit": "TLS 1.3",
            "pii_handling": "Field-level masking, anonymization for non-privileged roles"
        },
        "network_security": {
            "csrf": "Double-submit cookie pattern (csrf-csrf)",
            "cors": "Strict origin validation, no wildcards",
            "headers": "CSP, HSTS, X-Frame-Options, X-Content-Type-Options"
        }
    },
    "continuous_monitoring": {
        "vulnerability_scanning": "npm audit in CI/CD pipeline",
        "security_events": "Sentry error tracking + Azure Application Insights",
        "audit_review": "Quarterly audit log review",
        "penetration_testing": "Annual third-party assessment"
    },
    "certification_status": {
        "fedramp_low": {
            "readiness": "85%",
            "blockers": "None - all mitigated"
        },
        "fedramp_moderate": {
            "readiness": "75%",
            "blockers": "Key Vault migration recommended"
        },
        "soc2_type2": {
            "readiness": "70%",
            "blockers": "Audit evidence collection in progress"
        }
    }
}