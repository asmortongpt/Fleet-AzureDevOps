{
  "agent_id": 5,
  "name": "VehicleService",
  "file": "api/src/modules/fleet/services/vehicle.service.ts",
  "status": "success",
  "content": "import { injectable, inject } from \"inversify\";\nimport { BaseService } from \"../../../services/base.service\";\nimport { TYPES } from \"../../../types\";\nimport { VehicleRepository } from \"../repositories/vehicle.repository\";\n\n@injectable()\nexport class VehicleService extends BaseService {\n  constructor(@inject(TYPES.VehicleRepository) private vehicleRepository: VehicleRepository) {\n    super();\n  }\n\n  async validate(data: any): Promise<void> {\n    if (!data.vin) {\n      throw new Error(\"Vehicle VIN is required\");\n    }\n    if (!data.make) {\n      throw new Error(\"Vehicle make is required\");\n    }\n    if (!data.model) {\n      throw new Error(\"Vehicle model is required\");\n    }\n    if (!data.year) {\n      throw new Error(\"Vehicle year is required\");\n    }\n  }\n\n  async getAllVehicles(tenantId: string): Promise<any[]> {\n    return this.executeInTransaction(async () => {\n      return await this.vehicleRepository.findByTenant(tenantId);\n    });\n  }\n\n  async getVehicleById(id: number, tenantId: string): Promise<any | null> {\n    return this.executeInTransaction(async () => {\n      return await this.vehicleRepository.findById(id, tenantId);\n    });\n  }\n\n  async createVehicle(data: any, tenantId: string): Promise<any> {\n    await this.validate(data);\n    return this.executeInTransaction(async () => {\n      return await this.vehicleRepository.create(data, tenantId);\n    });\n  }\n\n  async updateVehicle(id: number, data: any, tenantId: string): Promise<any | null> {\n    return this.executeInTransaction(async () => {\n      return await this.vehicleRepository.update(id, data, tenantId);\n    });\n  }\n\n  async deleteVehicle(id: number, tenantId: string): Promise<boolean> {\n    return this.executeInTransaction(async () => {\n      return await this.vehicleRepository.delete(id, tenantId);\n    });\n  }\n\n  async getStatus(vehicleId: string, tenantId: string): Promise<any> {\n    return this.executeInTransaction(async () => {\n      const vehicle = await this.vehicleRepository.findById(parseInt(vehicleId), tenantId);\n      if (!vehicle) {\n        return null;\n      }\n      return {\n        id: vehicle.id,\n        status: vehicle.status || 'active',\n        lastUpdated: vehicle.updated_at || new Date()\n      };\n    });\n  }\n}",
  "timestamp": "2026-01-18T16:21:48.527553"
}