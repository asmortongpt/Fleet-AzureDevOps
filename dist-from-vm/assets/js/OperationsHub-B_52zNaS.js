function e({onVehicleSelect:e,selectedVehicleId:s,showDispatchOverlay:x=!0,showRouteOptimization:m=!1,showGeofences:o=!1}){const{data:h=[]}=u(),[j,p]=t.useState(6),[b,v]=t.useState({lat:28.5383,lng:-81.3792}),g=h.filter(e=>null!=e.latitude&&null!=e.longitude),w=g.filter(e=>"active"===e.status),y=w.slice(0,Math.floor(.6*w.length)),z=w.slice(Math.floor(.6*w.length)),k=(e,t)=>{if(s===e)return"bg-blue-600 ring-4 ring-blue-300";switch(t){case"active":return"bg-green-500 hover:bg-green-600";case"maintenance":return"bg-amber-500 hover:bg-amber-600";case"inactive":return"bg-gray-400 hover:bg-gray-500";default:return"bg-blue-500 hover:bg-blue-600"}},D=e=>y.includes(e)?a.jsx(n,{size:16,className:"text-white"}):a.jsx(d,{size:16,className:"text-white"});return a.jsxs("div",{className:"w-full h-full relative bg-gradient-to-br from-slate-100 to-blue-50","data-testid":"operations-hub-map",children:[a.jsxs("div",{className:"absolute top-4 left-4 z-20 bg-white rounded-lg shadow-lg p-4 max-w-xs",children:[a.jsx("h3",{className:"font-semibold text-sm mb-3 text-slate-800",children:"Operations Overview"}),a.jsxs("div",{className:"space-y-2 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),a.jsxs("span",{children:["Active Dispatch (",y.length," en route)"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 bg-amber-500 rounded-full"}),a.jsxs("span",{children:["Maintenance (",h.filter(e=>"maintenance"===e.status).length,")"]})]}),o&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(l,{className:"w-3 h-3 text-purple-500"}),a.jsx("span",{children:"Geofence Zones (3 active)"})]})]})]}),a.jsxs("div",{className:"absolute top-4 right-4 z-20 flex flex-col gap-2",children:[a.jsx(f,{size:"icon",variant:"secondary",onClick:()=>p(Math.min(j+1,18)),"data-testid":"map-zoom-in",className:"shadow-lg",children:"+"}),a.jsx(f,{size:"icon",variant:"secondary",onClick:()=>p(Math.max(j-1,1)),"data-testid":"map-zoom-out",className:"shadow-lg",children:"âˆ’"}),a.jsx(f,{size:"icon",variant:"secondary","data-testid":"map-locate",className:"shadow-lg",children:a.jsx(i,{className:"h-4 w-4"})})]}),m&&a.jsx("div",{className:"absolute bottom-4 left-4 z-20 bg-white rounded-lg shadow-lg p-4 max-w-sm",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(c,{className:"h-5 w-5 text-amber-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm text-slate-800",children:"Route Optimization Suggestion"}),a.jsx("p",{className:"text-xs text-slate-600 mt-1",children:"Rerouting vehicles V-042 and V-087 could save 23 minutes and reduce fuel costs by $12."}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx(f,{size:"sm",variant:"default",className:"text-xs",children:"Apply"}),a.jsx(f,{size:"sm",variant:"outline",className:"text-xs",children:"Details"})]})]})]})}),x&&a.jsxs("div",{className:"absolute top-20 left-4 z-10 bg-white/90 backdrop-blur-sm rounded-lg shadow-lg p-3 max-w-xs",children:[a.jsxs("h4",{className:"font-semibold text-xs text-slate-700 mb-2 flex items-center gap-2",children:[a.jsx(r,{className:"h-4 w-4 text-blue-500"}),"Active Dispatches"]}),a.jsxs("div",{className:"space-y-1.5",children:[y.slice(0,3).map((e,s)=>a.jsxs("div",{className:"flex items-center justify-between text-xs bg-white rounded p-2",children:[a.jsx("span",{className:"font-medium text-slate-800",children:e.vehicleNumber}),a.jsx(N,{variant:"outline",className:"text-xs",children:0===s?"Delivery":1===s?"Pickup":"Transfer"})]},e.id)),y.length>3&&a.jsxs("div",{className:"text-xs text-slate-500 text-center pt-1",children:["+",y.length-3," more"]})]})]}),o&&a.jsx("div",{className:"absolute inset-0 pointer-events-none",children:a.jsxs("svg",{className:"w-full h-full",children:[a.jsx("circle",{cx:"30%",cy:"40%",r:"80",fill:"rgba(147, 51, 234, 0.1)",stroke:"rgba(147, 51, 234, 0.5)",strokeWidth:"2",strokeDasharray:"5,5"}),a.jsx("circle",{cx:"60%",cy:"50%",r:"100",fill:"rgba(59, 130, 246, 0.1)",stroke:"rgba(59, 130, 246, 0.5)",strokeWidth:"2",strokeDasharray:"5,5"}),a.jsx("circle",{cx:"75%",cy:"35%",r:"60",fill:"rgba(16, 185, 129, 0.1)",stroke:"rgba(16, 185, 129, 0.5)",strokeWidth:"2",strokeDasharray:"5,5"})]})}),a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsxs("div",{className:"relative w-full h-full max-w-6xl max-h-[800px]",children:[a.jsxs("div",{className:"text-center space-y-4 absolute top-10 left-1/2 transform -translate-x-1/2 z-0",children:[a.jsx("div",{className:"text-6xl",children:"ðŸ—ºï¸"}),a.jsx("div",{className:"text-lg font-semibold text-slate-700",children:"Live Operations Map"}),a.jsxs("div",{className:"text-sm text-slate-500",children:[g.length," vehicles â€¢ ",y.length," en route â€¢ ",z.length," idle"]})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center mt-32",children:a.jsx("div",{className:"grid grid-cols-6 gap-4 max-w-4xl",children:g.slice(0,24).map(s=>{const t=y.includes(s);return a.jsxs("div",{onClick:()=>e?.(s.id),className:`\n                      cursor-pointer transition-all duration-200 transform hover:scale-125\n                      ${k(s.id,s.status)}\n                      p-3 rounded-full shadow-lg relative group\n                      ${t?"animate-pulse":""}\n                    `,"data-testid":`map-marker-${s.id}`,title:`${s.vehicleNumber} - ${t?"En Route":"Idle"}`,children:[D(s),a.jsxs("div",{className:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-900 text-white text-xs rounded py-1 px-2 whitespace-nowrap pointer-events-none",children:[s.vehicleNumber,a.jsx("br",{}),t?"En Route":"Idle"]})]},s.id)})})}),s&&a.jsx("div",{className:"absolute bottom-4 right-4 z-20 bg-white rounded-lg shadow-xl p-4 max-w-xs",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(r,{className:"h-5 w-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm text-slate-800",children:"Load Planning"}),a.jsxs("div",{className:"mt-2 space-y-1 text-xs text-slate-600",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Cargo Capacity:"}),a.jsx("span",{className:"font-medium",children:"1,200 lbs"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Current Load:"}),a.jsx("span",{className:"font-medium text-green-600",children:"850 lbs (71%)"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Available:"}),a.jsx("span",{className:"font-medium",children:"350 lbs"})]})]}),a.jsx("div",{className:"mt-3 h-2 bg-slate-200 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-green-500",style:{width:"71%"}})})]})]})})]})})]})}function s(){const{data:s=[],isLoading:l}=u(),{data:V=[]}=b(),{data:M=[]}=v(),[S,A]=t.useState(null),[L,O]=t.useState(!0),[R,F]=t.useState(!1),[I,$]=t.useState(!1),G=t.useMemo(()=>{const e=s.filter(e=>"active"===e.status),t=Math.floor(.6*e.length),a=Math.floor(.3*M.length);return{activeJobs:t,pendingDispatch:Math.floor(.1*M.length),enRoute:t,completed:a,totalVehicles:s.length,activeVehicles:e.length,availableDrivers:Math.floor(.4*V.length)}},[s,V,M]),P=t.useMemo(()=>[{id:"1",type:"warning",message:"Vehicle V-042 delayed 15 minutes - traffic incident on I-4",timestamp:new Date(Date.now()-3e5).toLocaleTimeString()},{id:"2",type:"info",message:"Route optimization available for 3 vehicles - potential savings: $45",timestamp:new Date(Date.now()-72e4).toLocaleTimeString()},{id:"3",type:"critical",message:"Geofence breach: Vehicle V-088 entered restricted zone",timestamp:new Date(Date.now()-138e4).toLocaleTimeString()}],[]),T=s.find(e=>e.id===S),E=a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Operations Hub"}),a.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Real-time fleet operations control center"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx(g,{className:"border-l-4 border-l-blue-500",children:a.jsx(w,{className:"pt-4 pb-3 px-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:G.activeJobs}),a.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Active Jobs"})]}),a.jsx(r,{className:"h-8 w-8 text-blue-500 opacity-20"})]})})}),a.jsx(g,{className:"border-l-4 border-l-amber-500",children:a.jsx(w,{className:"pt-4 pb-3 px-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-amber-600",children:G.pendingDispatch}),a.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Pending Dispatch"})]}),a.jsx(x,{className:"h-8 w-8 text-amber-500 opacity-20"})]})})}),a.jsx(g,{className:"border-l-4 border-l-green-500",children:a.jsx(w,{className:"pt-4 pb-3 px-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:G.enRoute}),a.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"En Route"})]}),a.jsx(n,{className:"h-8 w-8 text-green-500 opacity-20"})]})})}),a.jsx(g,{className:"border-l-4 border-l-purple-500",children:a.jsx(w,{className:"pt-4 pb-3 px-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:G.completed}),a.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Completed Today"})]}),a.jsx(m,{className:"h-8 w-8 text-purple-500 opacity-20"})]})})})]}),a.jsxs(g,{children:[a.jsx(y,{className:"pb-3",children:a.jsxs(z,{className:"text-sm flex items-center gap-2",children:[a.jsx(o,{className:"h-4 w-4"}),"Map Display Options"]})}),a.jsxs(w,{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(D,{htmlFor:"dispatch-overlay",className:"text-xs cursor-pointer",children:"Active Dispatches"}),a.jsx(C,{id:"dispatch-overlay",checked:L,onCheckedChange:O})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(D,{htmlFor:"route-optimization",className:"text-xs cursor-pointer",children:"Route Suggestions"}),a.jsx(C,{id:"route-optimization",checked:R,onCheckedChange:F})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(D,{htmlFor:"geofences",className:"text-xs cursor-pointer",children:"Geofence Zones"}),a.jsx(C,{id:"geofences",checked:I,onCheckedChange:$})]})]})]}),a.jsxs(g,{className:"border-l-4 border-l-red-500",children:[a.jsx(y,{className:"pb-3",children:a.jsxs(z,{className:"text-sm flex items-center gap-2",children:[a.jsx(c,{className:"h-4 w-4 text-red-500"}),"Critical Alerts"]})}),a.jsx(w,{children:a.jsx("div",{className:"space-y-3 max-h-48 overflow-y-auto",children:P.map(e=>a.jsx("div",{className:"p-3 rounded-lg border text-xs "+("critical"===e.type?"bg-red-50 border-red-200":"warning"===e.type?"bg-amber-50 border-amber-200":"bg-blue-50 border-blue-200"),children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(c,{className:"h-4 w-4 flex-shrink-0 mt-0.5 "+("critical"===e.type?"text-red-500":"warning"===e.type?"text-amber-500":"text-blue-500")}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-slate-800 font-medium",children:e.message}),a.jsx("p",{className:"text-slate-500 mt-1",children:e.timestamp})]})]})},e.id))})})]}),a.jsxs(g,{children:[a.jsx(y,{className:"pb-3",children:a.jsxs(z,{className:"text-sm flex items-center gap-2",children:[a.jsx(h,{className:"h-4 w-4"}),"Fleet Status"]})}),a.jsxs(w,{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("span",{className:"text-slate-600 flex items-center gap-2",children:[a.jsx(d,{className:"h-4 w-4"}),"Active Vehicles"]}),a.jsxs("span",{className:"font-semibold text-slate-900",children:[G.activeVehicles," / ",G.totalVehicles]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("span",{className:"text-slate-600 flex items-center gap-2",children:[a.jsx(j,{className:"h-4 w-4"}),"Available Drivers"]}),a.jsx("span",{className:"font-semibold text-slate-900",children:G.availableDrivers})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("span",{className:"text-slate-600 flex items-center gap-2",children:[a.jsx(p,{className:"h-4 w-4"}),"Efficiency Score"]}),a.jsx("span",{className:"font-semibold text-green-600",children:"92%"})]})]})]}),T&&a.jsxs(g,{className:"border-2 border-blue-500",children:[a.jsx(y,{className:"pb-3",children:a.jsxs(z,{className:"text-sm flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"h-4 w-4 text-blue-500"}),T.vehicleNumber]}),a.jsx(N,{variant:"active"===T.status?"default":"secondary",children:T.status})]})}),a.jsxs(w,{className:"space-y-2 text-xs",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Make/Model:"}),a.jsxs("span",{className:"font-medium",children:[T.make," ",T.model]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Location:"}),a.jsxs("span",{className:"font-medium",children:[T.latitude?.toFixed(4),", ",T.longitude?.toFixed(4)]})]}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx(f,{size:"sm",className:"flex-1 text-xs",children:"View Details"}),a.jsx(f,{size:"sm",variant:"outline",className:"flex-1 text-xs",children:"Dispatch"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-semibold text-slate-700",children:"Quick Actions"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs(f,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",children:[a.jsx(r,{className:"h-4 w-4"}),"New Job"]}),a.jsxs(f,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",children:[a.jsx(n,{className:"h-4 w-4"}),"Optimize Routes"]}),a.jsxs(f,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",children:[a.jsx(i,{className:"h-4 w-4"}),"Add Geofence"]}),a.jsxs(f,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",children:[a.jsx(d,{className:"h-4 w-4"}),"Assign Vehicle"]})]})]})]}),J=T&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-lg font-bold",children:["Operations Details: ",T.vehicleNumber]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(g,{children:[a.jsx(y,{children:a.jsx(z,{className:"text-sm",children:"Vehicle Information"})}),a.jsxs(w,{className:"text-sm space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Make/Model:"}),a.jsxs("span",{className:"font-medium",children:[T.make," ",T.model]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Status:"}),a.jsx(N,{variant:"active"===T.status?"default":"secondary",children:T.status})]})]})]}),a.jsxs(g,{children:[a.jsx(y,{children:a.jsx(z,{className:"text-sm",children:"Current Load"})}),a.jsxs(w,{className:"text-sm space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Capacity:"}),a.jsx("span",{className:"font-medium",children:"1,200 lbs"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-slate-600",children:"Current:"}),a.jsx("span",{className:"font-medium text-green-600",children:"850 lbs (71%)"})]}),a.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden mt-2",children:a.jsx("div",{className:"h-full bg-green-500",style:{width:"71%"}})})]})]})]})]});return l?a.jsx("div",{className:"flex items-center justify-center h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx(r,{className:"h-12 w-12 animate-spin mx-auto text-blue-500"}),a.jsx("p",{className:"mt-4 text-slate-600",children:"Loading operations data..."})]})}):a.jsx(k,{mapComponent:a.jsx(e,{onVehicleSelect:A,selectedVehicleId:S,showDispatchOverlay:L,showRouteOptimization:R,showGeofences:I}),sidePanel:E,drawerContent:J})}import{r as t,j as a,cv as l,aD as i,I as c,aQ as r,c8 as n,O as d,aC as x,aA as m,a0 as o,aw as h,U as j,aB as p}from"./react-core-hQu9tqS1.js";import{r as u,h as f,B as N,Q as b,V as v,C as g,f as w,d as y,e as z}from"./index-BDwglPMF.js";import{M as k}from"./MapFirstLayout-DjypJrVA.js";import{L as D}from"./label-C9sYRYKW.js";import{S as C}from"./switch-9MiV1CpI.js";import"./lazy-modules-Bs19xeuI.js";import"./form-vendor-DKCvS-hL.js";import"./chart-vendor-DWRb53_H.js";import"./utils-vendor-Bojdf5C8.js";import"./mui-core-BKffG9O1.js";import"./react-router-cBrq_s0x.js";import"./query-vendor--Fe2N4Al.js";import"./three-helpers-DedzJcO9.js";import"./three-core-ZrcxJ5g9.js";import"./three-react-B1s7Iy2r.js";import"./ui-radix-C-X5Qx_8.js";import"./ui-dialogs-C2yTnBPV.js";import"./animation-vendor-Cf_i_fm0.js";import"./date-vendor-npJ7nI92.js";import"./ui-menus--48tEbqQ.js";import"./sheet-B4c1gADU.js";export{s as OperationsHub};
