function e({url:e,vehicleType:t}){const{scene:r}=p(e);return n.useEffect(()=>{const e=d;r.traverse(t=>{if(t.isMesh){const n=t.name.toLowerCase();n.includes("body")||n.includes("paint")?t.material=e.createCarPaintMaterial("#1a5490","gloss"):n.includes("glass")||n.includes("window")?t.material=e.createAutomotiveGlass(.3):n.includes("chrome")||n.includes("trim")?t.material=e.createChromeMaterial():(n.includes("tire")||n.includes("wheel"))&&(t.material=e.createTireMaterial())}})},[r,t]),a.jsx("primitive",{object:r})}function t({modelUrl:t,vehicleType:o="sedan"}){const l=n.useRef(null),[s,i]=n.useState(null),[c,m]=n.useState("hero"),[u,f]=n.useState(!0);return n.useEffect(()=>{const e=function(){const e=document.createElement("canvas");e.width=1,e.height=1;let t=e.getContext("webgl2");const n=!!t;if(t||(t=e.getContext("webgl")||e.getContext("experimental-webgl")),!t)return null;const a=t.getExtension("WEBGL_debug_renderer_info"),r={webgl:!0,webgl2:n,maxTextureSize:t.getParameter(t.MAX_TEXTURE_SIZE),maxVertexTextures:t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxFragmentTextures:t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),maxVaryingVectors:t.getParameter(t.MAX_VARYING_VECTORS),maxVertexAttribs:t.getParameter(t.MAX_VERTEX_ATTRIBS),maxRenderBufferSize:t.getParameter(t.MAX_RENDERBUFFER_SIZE),renderer:a?t.getParameter(a.UNMASKED_RENDERER_WEBGL):"Unknown",vendor:a?t.getParameter(a.UNMASKED_VENDOR_WEBGL):"Unknown",version:t.getParameter(t.VERSION),extensions:{astc:!!t.getExtension("WEBGL_compressed_texture_astc"),etc1:!!t.getExtension("WEBGL_compressed_texture_etc1"),etc2:!!t.getExtension("WEBGL_compressed_texture_etc"),pvrtc:!!t.getExtension("WEBGL_compressed_texture_pvrtc"),s3tc:!!t.getExtension("WEBGL_compressed_texture_s3tc"),bptc:!!t.getExtension("EXT_texture_compression_bptc"),rgtc:!!t.getExtension("EXT_texture_compression_rgtc")}};return e.remove(),r}();i(e)},[]),a.jsxs("div",{className:"relative w-full h-full",children:[a.jsx(r,{ref:l,shadows:!0,dpr:s?.webgl2?[1,2]:[1,1.5],gl:{antialias:!0,alpha:!0,powerPreference:"high-performance"},children:a.jsxs(n.Suspense,{fallback:null,children:[a.jsx(v,{makeDefault:!0,position:[4,2,4],fov:50}),a.jsx("ambientLight",{intensity:.3}),a.jsx("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048}),a.jsx("directionalLight",{position:[-10,5,-5],intensity:.5}),a.jsx(g,{preset:"sunset",background:!1}),a.jsx(e,{url:t,vehicleType:o}),a.jsx(h,{enablePan:!0,enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2,minDistance:2,maxDistance:20})]})}),u&&a.jsxs("div",{className:"absolute top-4 right-4 bg-white/90 rounded-lg shadow-lg p-4 space-y-2",children:[a.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Camera Presets"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:["hero","frontQuarter","rearQuarter","profile","topDown","interior","engineBay","wheelDetail"].map(e=>a.jsx("button",{onClick:()=>(e=>{m(e)})(e),className:"px-3 py-1 text-xs rounded "+(c===e?"bg-blue-600 text-white":"bg-gray-200 hover:bg-gray-300"),children:e},e))})]}),s&&a.jsxs("div",{className:"absolute bottom-4 left-4 bg-black/70 text-white text-xs px-3 py-2 rounded",children:["WebGL ",s.webgl2?"2.0":"1.0"]})]})}import{r as n,j as a}from"./react-core-hQu9tqS1.js";import{C as r}from"./three-react-B1s7Iy2r.js";import{a0 as o,g as l,a1 as s,a2 as i,a3 as c,Y as m,a4 as u,a5 as f}from"./three-core-ZrcxJ5g9.js";import{P as v,E as g,O as h,u as p}from"./three-helpers-DedzJcO9.js";import"./lazy-modules-Bs19xeuI.js";import"./form-vendor-DKCvS-hL.js";import"./chart-vendor-DWRb53_H.js";import"./utils-vendor-Bojdf5C8.js";import"./mui-core-BKffG9O1.js";const d={createCarPaintMaterial:(e,t="gloss")=>{const n=new o(e),a={matte:{roughness:.8,clearcoat:.1,metallic:.1},gloss:{roughness:.05,clearcoat:1,metallic:.95},satin:{roughness:.3,clearcoat:.6,metallic:.7}}[t];return new l({uniforms:{baseColor:{value:n},metallic:{value:a.metallic},roughness:{value:a.roughness},clearcoat:{value:a.clearcoat},clearcoatRoughness:{value:.05},orangePeel:{value:.02},metalFlakes:{value:.5},time:{value:0}},vertexShader:"\n    varying vec3 vNormal;\n    varying vec3 vPosition;\n    varying vec3 vViewPosition;\n    varying vec2 vUv;\n    \n    void main() {\n      vNormal = normalize(normalMatrix * normal);\n      vPosition = position;\n      vUv = uv;\n      \n      vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n      vViewPosition = -mvPosition.xyz;\n      \n      gl_Position = projectionMatrix * mvPosition;\n    }\n  ",fragmentShader:"\n    uniform vec3 baseColor;\n    uniform float metallic;\n    uniform float roughness;\n    uniform float clearcoat;\n    uniform float clearcoatRoughness;\n    uniform float orangePeel;\n    uniform float metalFlakes;\n    uniform float time;\n    \n    varying vec3 vNormal;\n    varying vec3 vPosition;\n    varying vec3 vViewPosition;\n    varying vec2 vUv;\n    \n    // Noise function for surface details\n    float noise(vec2 uv) {\n      return fract(sin(dot(uv, vec2(12.9898, 78.233))) * 43758.5453);\n    }\n    \n    // Orange peel bump mapping\n    vec3 orangePeelNormal(vec2 uv, float intensity) {\n      float scale = 150.0;\n      vec2 offset = vec2(0.001);\n      \n      float h1 = noise(uv * scale) * intensity;\n      float h2 = noise((uv + offset.xy) * scale) * intensity;\n      float h3 = noise((uv + offset.yx) * scale) * intensity;\n      \n      vec3 normal = normalize(vec3(h2 - h1, h3 - h1, 1.0));\n      return normal;\n    }\n    \n    // Metallic flakes sparkle\n    float metallicSparkle(vec2 uv, float density) {\n      vec2 grid = floor(uv * density);\n      float sparkle = noise(grid);\n      \n      // Create sparkle hotspots\n      if (sparkle > 0.98) {\n        return pow(sparkle, 4.0) * 2.0;\n      }\n      return 0.0;\n    }\n    \n    void main() {\n      vec3 normal = normalize(vNormal);\n      vec3 viewDir = normalize(vViewPosition);\n      \n      // Apply orange peel texture\n      vec3 orangePeelNorm = orangePeelNormal(vUv, orangePeel);\n      normal = normalize(normal + orangePeelNorm * 0.1);\n      \n      // Fresnel effect\n      float fresnel = pow(1.0 - max(dot(normal, viewDir), 0.0), 2.0);\n      \n      // Metallic flakes\n      float flakes = metallicSparkle(vUv, 500.0) * metalFlakes;\n      \n      // Base color with subtle variations\n      vec3 finalColor = baseColor;\n      finalColor += vec3(flakes) * 0.3;\n      \n      // Clearcoat reflection\n      float clearcoatFactor = clearcoat * fresnel;\n      finalColor = mix(finalColor, vec3(1.0), clearcoatFactor * 0.2);\n      \n      // Depth and richness\n      finalColor *= (1.0 + fresnel * 0.3);\n      \n      gl_FragColor = vec4(finalColor, 1.0);\n    }\n  ",transparent:!1})},createAutomotiveGlass:(e=.1)=>new u({color:new o(.9,.95,1),metalness:0,roughness:0,transmission:.98,transparent:!0,opacity:.1+e,ior:1.52,thickness:.01,envMapIntensity:2,clearcoat:1,clearcoatRoughness:.01,emissive:new o(.01,.02,.05),side:f}),createChromeMaterial:()=>new s({color:16777215,metalness:1,roughness:.02,envMapIntensity:3,map:null}),createTireMaterial:()=>{const e=new s({color:1710618,metalness:0,roughness:.95,normalScale:new m(2,2),envMapIntensity:.1}),t=document.createElement("canvas");t.width=512,t.height=512;const n=t.getContext("2d");n.fillStyle="#1a1a1a",n.fillRect(0,0,512,512),n.fillStyle="#0a0a0a";for(let r=0;20>r;r++){const e=r/20*512;n.fillRect(0,e,512,8);for(let t=0;10>t;t++)n.fillRect(t/10*512,e+2,40,4)}const a=new i(t);return a.wrapS=a.wrapT=c,a.repeat.set(4,1),e.map=a,e},createLeatherMaterial:(e="#8B4513")=>{const t=new s({color:new o(e),metalness:.05,roughness:.7,envMapIntensity:.3}),n=document.createElement("canvas");n.width=256,n.height=256;const a=n.getContext("2d"),r=new o(e);a.fillStyle=`rgb(${255*r.r}, ${255*r.g}, ${255*r.b})`,a.fillRect(0,0,256,256);for(let o=0;1e3>o;o++){const e=256*Math.random(),t=256*Math.random(),n=3*Math.random()+1;a.fillStyle=`rgba(0,0,0,${.1*Math.random()+.05})`,a.beginPath(),a.arc(e,t,n,0,2*Math.PI),a.fill()}const l=new i(n);return t.map=l,t},createCarbonFiberMaterial:()=>{const e=new s({color:1118481,metalness:.8,roughness:.2,envMapIntensity:1.5}),t=document.createElement("canvas");t.width=512,t.height=512;const n=t.getContext("2d");n.fillStyle="#111111",n.fillRect(0,0,512,512);const a=32;for(let o=0;512>o;o+=a)for(let e=0;512>e;e+=a){const t=(Math.floor(o/a)+Math.floor(e/a))%2;n.fillStyle=t?"#1a1a1a":"#0a0a0a",n.fillRect(o,e,a,a),n.fillStyle=t?"#333333":"#222222";for(let r=0;a>r;r+=2)t?n.fillRect(o+r,e,1,a):n.fillRect(o,e+r,a,1)}const r=new i(t);return r.wrapS=r.wrapT=c,e.map=r,e},createAluminumMaterial:()=>new s({color:14540253,metalness:.95,roughness:.1,envMapIntensity:2}),createBrakeDiscMaterial:()=>{const e=new s({color:6710886,metalness:.8,roughness:.3,envMapIntensity:1}),t=document.createElement("canvas");t.width=256,t.height=256;const n=t.getContext("2d");n.fillStyle="#666666",n.fillRect(0,0,256,256),n.fillStyle="#333333";for(let r=0;12>r;r++){const e=r/12*Math.PI*2,t=120;for(let a=30;t>a;a+=10){const t=128+Math.cos(e)*a,r=128+Math.sin(e)*a;n.fillRect(t-2,r-1,4,2)}}const a=new i(t);return e.map=a,e}};n.createContext(null);export{t as Asset3DViewer};
