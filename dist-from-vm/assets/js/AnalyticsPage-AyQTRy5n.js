function e({title:e,value:s,change:t,changeLabel:a,icon:i,trend:n="neutral",variant:r="default"}){const c="up"===n?l.jsx(j,{className:"w-4 h-4 text-green-500"}):"down"===n?l.jsx(u,{className:"w-4 h-4 text-red-500"}):null;return l.jsx(b,{className:`${{default:"border-slate-700/50 bg-slate-800/40",success:"border-green-700/50 bg-green-900/20",warning:"border-yellow-700/50 bg-yellow-900/20",danger:"border-red-700/50 bg-red-900/20"}[r]} backdrop-blur-xl border transition-all duration-300 hover:scale-105 hover:shadow-lg`,children:l.jsxs(w,{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-slate-400 uppercase tracking-wide",children:e}),l.jsx("div",{className:"text-slate-400",children:i})]}),l.jsxs("div",{className:"flex items-baseline justify-between",children:[l.jsx("span",{className:"text-3xl font-bold text-white",children:s}),void 0!==t&&l.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[c,l.jsxs("span",{className:"up"===n?"text-green-500":"down"===n?"text-red-500":"text-slate-400",children:[t>0?"+":"",t,"%"]})]})]}),a&&l.jsx("p",{className:"text-xs text-slate-500 mt-1",children:a})]})})}function s({title:e,value:s,subtitle:t,icon:a,children:n}){return l.jsxs(b,{className:"border-slate-700/50 bg-gradient-to-br from-slate-800/60 to-slate-900/60 backdrop-blur-xl",children:[l.jsxs(P,{children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs(A,{className:"text-lg font-semibold text-white flex items-center gap-2",children:[a,e]}),l.jsxs(L,{variant:"outline",className:"text-slate-300 border-slate-600",children:[l.jsx(i,{className:"w-3 h-3 mr-1"}),"Live"]})]}),l.jsxs("div",{className:"mt-2",children:[l.jsx("div",{className:"text-2xl font-bold text-white",children:s}),t&&l.jsx("p",{className:"text-sm text-slate-400 mt-1",children:t})]})]}),n&&l.jsx(w,{children:n})]})}function t(){const[t,j]=a.useState("7d"),{data:u=[],isLoading:P,isError:A}=g(),{data:D=[],isLoading:G,isError:S}=v(),{data:V=[],isLoading:k,isError:E}=f(),{data:T=[],isLoading:z,isError:I}=N(),{data:O=[],isLoading:U,isError:R}=p(),_=a.useMemo(()=>{const e=u,s=D,t=V,a=T,l=O,i=e.length,n=e.filter(e=>"active"===e.status).length,r=e.filter(e=>"maintenance"===e.status).length,c=i>0?(n/i*100).toFixed(1):"0",d=e.reduce((e,s)=>e+(s.odometer||0),0),o=i>0?Math.round(d/i):0,m=a.reduce((e,s)=>e+(s.total_cost||0),0),x=a.reduce((e,s)=>e+(s.gallons||0),0),h=x>0?(m/x).toFixed(2):"0.00",j=x>0?(d/x).toFixed(1):"0.0",g=l.filter(e=>"completed"===e.status).length,v=l.filter(e=>"pending"===e.status||"in_progress"===e.status).length,f=t.reduce((e,s)=>e+(s.cost||0),0);return{fleet:{total:i,active:n,inMaintenance:r,utilization:c},mileage:{total:d,avgPerVehicle:o},fuel:{totalCost:m,totalGallons:x,avgPrice:h,estimatedMPG:j},maintenance:{completed:g,pending:v,totalCost:f,avgCost:t.length>0?(f/t.length).toFixed(2):"0.00"},drivers:{total:s.length,active:s.filter(e=>"active"===e.status).length},costs:{costPerMile:d>0?((m+f)/d).toFixed(3):"0.000",totalOperating:m+f},safety:{criticalIssues:l.filter(e=>"high"===e.priority||"critical"===e.priority).length}}},[u,D,V,T,O]),Q=A||S||E||I||R;return P||G||k||z||U?l.jsx("div",{className:"flex items-center justify-center h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:l.jsxs("div",{className:"text-center space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-blue-500/30 border-t-blue-500 rounded-full animate-spin mx-auto"}),l.jsx(i,{className:"w-6 h-6 text-blue-500 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-lg font-medium text-white",children:"Loading Analytics Dashboard"}),l.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Fetching real-time fleet data..."})]})]})}):Q?l.jsx("div",{className:"flex items-center justify-center h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:l.jsx(b,{className:"max-w-md border-red-700/50 bg-red-900/20 backdrop-blur-xl",children:l.jsxs(w,{className:"p-6 text-center space-y-4",children:[l.jsx(n,{className:"w-12 h-12 text-red-500 mx-auto"}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white",children:"Failed to Load Analytics"}),l.jsx("p",{className:"text-slate-400 mt-2",children:"Unable to fetch fleet data. Please check your connection and try again."})]}),l.jsxs(y,{onClick:()=>window.location.reload(),variant:"outline",className:"mt-4",children:[l.jsx(i,{className:"w-4 h-4 mr-2"}),"Retry"]})]})})}):l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-6","data-testid":"analytics-page",children:[l.jsx("div",{className:"mb-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[l.jsx(r,{className:"w-8 h-8 text-blue-500"}),"Analytics Dashboard"]}),l.jsx("p",{className:"text-slate-400 mt-1",children:"Real-time fleet analytics and insights"})]}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx($,{value:t,onValueChange:e=>j(e),children:l.jsxs(F,{className:"bg-slate-800/60 border border-slate-700/50",children:[l.jsx(M,{value:"24h",children:"24h"}),l.jsx(M,{value:"7d",children:"7d"}),l.jsx(M,{value:"30d",children:"30d"}),l.jsx(M,{value:"90d",children:"90d"})]})})})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[l.jsx(e,{title:"Fleet Utilization",value:`${_.fleet.utilization}%`,change:5.2,changeLabel:"vs last period",icon:l.jsx(c,{className:"w-5 h-5"}),trend:"up",variant:"success"}),l.jsx(e,{title:"Cost per Mile",value:`$${_.costs.costPerMile}`,change:-2.3,changeLabel:"vs last period",icon:l.jsx(d,{className:"w-5 h-5"}),trend:"down",variant:"success"}),l.jsx(e,{title:"Average MPG",value:_.fuel.estimatedMPG,change:3.1,changeLabel:"vs last period",icon:l.jsx(o,{className:"w-5 h-5"}),trend:"up",variant:"default"}),l.jsx(e,{title:"Active Vehicles",value:`${_.fleet.active}/${_.fleet.total}`,icon:l.jsx(i,{className:"w-5 h-5"}),variant:"default"})]}),l.jsxs($,{defaultValue:"overview",className:"space-y-4",children:[l.jsxs(F,{className:"bg-slate-800/60 border border-slate-700/50",children:[l.jsxs(M,{value:"overview",children:[l.jsx(r,{className:"w-4 h-4 mr-2"}),"Overview"]}),l.jsxs(M,{value:"costs",children:[l.jsx(d,{className:"w-4 h-4 mr-2"}),"Costs"]}),l.jsxs(M,{value:"performance",children:[l.jsx(c,{className:"w-4 h-4 mr-2"}),"Performance"]}),l.jsxs(M,{value:"maintenance",children:[l.jsx(n,{className:"w-4 h-4 mr-2"}),"Maintenance"]})]}),l.jsxs(C,{value:"overview",className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[l.jsx(s,{title:"Fleet Status",value:`${_.fleet.total} Vehicles`,subtitle:`${_.fleet.active} active, ${_.fleet.inMaintenance} in maintenance`,icon:l.jsx(h,{className:"w-5 h-5"}),children:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-green-900/20 border border-green-700/30",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(m,{className:"w-5 h-5 text-green-500"}),l.jsx("span",{className:"text-sm font-medium text-white",children:"Active"})]}),l.jsxs(L,{variant:"outline",className:"bg-green-900/30 text-green-400 border-green-700/50",children:[_.fleet.active," vehicles"]})]}),l.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-yellow-900/20 border border-yellow-700/30",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(x,{className:"w-5 h-5 text-yellow-500"}),l.jsx("span",{className:"text-sm font-medium text-white",children:"Maintenance"})]}),l.jsxs(L,{variant:"outline",className:"bg-yellow-900/30 text-yellow-400 border-yellow-700/50",children:[_.fleet.inMaintenance," vehicles"]})]}),_.safety.criticalIssues>0&&l.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-red-900/20 border border-red-700/30",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(n,{className:"w-5 h-5 text-red-500"}),l.jsx("span",{className:"text-sm font-medium text-white",children:"Critical Issues"})]}),l.jsxs(L,{variant:"outline",className:"bg-red-900/30 text-red-400 border-red-700/50",children:[_.safety.criticalIssues," items"]})]})]})}),l.jsx(s,{title:"Driver Activity",value:`${_.drivers.active} Active`,subtitle:`${_.drivers.total} total drivers`,icon:l.jsx(i,{className:"w-5 h-5"}),children:l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-slate-400",children:"Active Drivers"}),l.jsx("span",{className:"text-white font-medium",children:_.drivers.active})]}),l.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-500",style:{width:(_.drivers.total>0?_.drivers.active/_.drivers.total*100:0)+"%"}})}),l.jsxs("p",{className:"text-xs text-slate-500",children:[_.drivers.total>0?(_.drivers.active/_.drivers.total*100).toFixed(0):0,"% of fleet active"]})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsx(s,{title:"Total Mileage",value:_.mileage.total.toLocaleString(),subtitle:"miles across all vehicles",icon:l.jsx(i,{className:"w-5 h-5"})}),l.jsx(s,{title:"Avg Miles/Vehicle",value:_.mileage.avgPerVehicle.toLocaleString(),subtitle:"average odometer reading",icon:l.jsx(c,{className:"w-5 h-5"})}),l.jsx(s,{title:"Fuel Efficiency",value:`${_.fuel.estimatedMPG} MPG`,subtitle:`${_.fuel.totalGallons.toLocaleString()} gallons consumed`,icon:l.jsx(o,{className:"w-5 h-5"})})]})]}),l.jsx(C,{value:"costs",className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[l.jsx(s,{title:"Total Operating Costs",value:`$${_.costs.totalOperating.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,subtitle:"Fuel + Maintenance costs",icon:l.jsx(d,{className:"w-5 h-5"}),children:l.jsxs("div",{className:"space-y-3 mt-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-slate-400",children:"Fuel Costs"}),l.jsxs("span",{className:"text-white font-medium",children:["$",_.fuel.totalCost.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-slate-400",children:"Maintenance Costs"}),l.jsxs("span",{className:"text-white font-medium",children:["$",_.maintenance.totalCost.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),l.jsxs("div",{className:"border-t border-slate-700/50 pt-2 flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-white",children:"Cost per Mile"}),l.jsxs("span",{className:"text-lg font-bold text-blue-400",children:["$",_.costs.costPerMile]})]})]})}),l.jsx(s,{title:"Fuel Analytics",value:`$${_.fuel.avgPrice}/gal`,subtitle:"Average fuel price",icon:l.jsx(o,{className:"w-5 h-5"}),children:l.jsxs("div",{className:"space-y-3 mt-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-slate-400",children:"Total Gallons"}),l.jsx("span",{className:"text-white font-medium",children:_.fuel.totalGallons.toLocaleString()})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-slate-400",children:"Total Fuel Cost"}),l.jsxs("span",{className:"text-white font-medium",children:["$",_.fuel.totalCost.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-slate-400",children:"Fleet MPG"}),l.jsx("span",{className:"text-white font-medium",children:_.fuel.estimatedMPG})]})]})})]})}),l.jsx(C,{value:"performance",className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[l.jsx(e,{title:"Fleet Utilization",value:`${_.fleet.utilization}%`,icon:l.jsx(c,{className:"w-5 h-5"}),variant:"success"}),l.jsx(e,{title:"Vehicle Availability",value:`${_.fleet.active}/${_.fleet.total}`,icon:l.jsx(m,{className:"w-5 h-5"}),variant:"default"}),l.jsx(e,{title:"Avg Fuel Efficiency",value:`${_.fuel.estimatedMPG} MPG`,icon:l.jsx(o,{className:"w-5 h-5"}),variant:"default"})]})}),l.jsx(C,{value:"maintenance",className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[l.jsx(s,{title:"Work Orders",value:`${_.maintenance.completed+_.maintenance.pending} Total`,subtitle:`${_.maintenance.completed} completed, ${_.maintenance.pending} pending`,icon:l.jsx(i,{className:"w-5 h-5"}),children:l.jsxs("div",{className:"space-y-3 mt-4",children:[l.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-green-900/20 border border-green-700/30",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(m,{className:"w-5 h-5 text-green-500"}),l.jsx("span",{className:"text-sm font-medium text-white",children:"Completed"})]}),l.jsx(L,{variant:"outline",className:"bg-green-900/30 text-green-400 border-green-700/50",children:_.maintenance.completed})]}),l.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-yellow-900/20 border border-yellow-700/30",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(x,{className:"w-5 h-5 text-yellow-500"}),l.jsx("span",{className:"text-sm font-medium text-white",children:"Pending"})]}),l.jsx(L,{variant:"outline",className:"bg-yellow-900/30 text-yellow-400 border-yellow-700/50",children:_.maintenance.pending})]})]})}),l.jsx(s,{title:"Maintenance Costs",value:`$${_.maintenance.avgCost}`,subtitle:"Average cost per maintenance",icon:l.jsx(d,{className:"w-5 h-5"}),children:l.jsxs("div",{className:"space-y-3 mt-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-slate-400",children:"Total Maintenance Cost"}),l.jsxs("span",{className:"text-white font-medium",children:["$",_.maintenance.totalCost.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-slate-400",children:"Average per Service"}),l.jsxs("span",{className:"text-white font-medium",children:["$",_.maintenance.avgCost]})]})]})})]})})]})]})}import{r as a,j as l,ax as i,I as n,Q as r,aH as c,aV as d,_ as o,aA as m,aC as x,d6 as h,aw as j,aI as u}from"./react-core-hQu9tqS1.js";import{r as g,Q as v,R as f,U as N,V as p,C as b,f as w,h as y,T as $,a as F,b as M,c as C,B as L,d as P,e as A}from"./index-BDwglPMF.js";import"./lazy-modules-Bs19xeuI.js";import"./form-vendor-DKCvS-hL.js";import"./chart-vendor-DWRb53_H.js";import"./utils-vendor-Bojdf5C8.js";import"./mui-core-BKffG9O1.js";import"./react-router-cBrq_s0x.js";import"./query-vendor--Fe2N4Al.js";import"./three-helpers-DedzJcO9.js";import"./three-core-ZrcxJ5g9.js";import"./three-react-B1s7Iy2r.js";import"./ui-radix-C-X5Qx_8.js";import"./ui-dialogs-C2yTnBPV.js";import"./animation-vendor-Cf_i_fm0.js";import"./date-vendor-npJ7nI92.js";import"./ui-menus--48tEbqQ.js";export{t as AnalyticsPage,t as default};
