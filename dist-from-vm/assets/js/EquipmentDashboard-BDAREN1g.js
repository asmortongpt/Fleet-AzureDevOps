function e(){const[e,E]=s.useState([]),[z,C]=s.useState([]),[M,T]=s.useState([]),[F,I]=s.useState([]),[U,A]=s.useState([]),[O,D]=s.useState(!0),[P,R]=s.useState("overview");s.useEffect(()=>{B()},[]);const B=async()=>{try{D(!0);const[e,s,a,t]=await Promise.all([r.get("/api/heavy-equipment"),r.get("/api/heavy-equipment/maintenance/schedules"),r.get("/api/heavy-equipment/certifications/expiring?days=60"),r.get("/api/heavy-equipment/certifications/matrix")]);S(e)&&e.data?.equipment&&E(e.data.equipment),S(s)&&s.data?.schedules&&C(s.data.schedules),S(a)&&a.data?.alerts&&T(a.data.alerts),S(t)&&t.data?.matrix&&A(t.data.matrix)}catch(e){c.error("Error fetching dashboard data:",e),n.error("Failed to load dashboard data")}finally{D(!1)}},G=e.length,H=e.filter(e=>"available"===e.availability_status).length,L=e.filter(e=>"in_use"===e.availability_status).length,V=e.filter(e=>"maintenance"===e.availability_status).length,W=e.filter(e=>e.is_rental).length,k=z.filter(e=>"overdue"===e.status).length,J=z.filter(e=>"scheduled"===e.status&&(null!=e.hours_until_due&&50>e.hours_until_due||null!=e.days_until_due&&30>e.days_until_due)).length,K=M.filter(e=>30>=e.days_until_expiry).length,Q=M.filter(e=>0>e.days_until_expiry).length;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Equipment Dashboard"}),a.jsx("p",{className:"text-muted-foreground",children:"Comprehensive view of heavy equipment utilization, maintenance, and certifications"})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs(d,{children:[a.jsx(x,{className:"pb-3",children:a.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Total Equipment"})}),a.jsxs(o,{children:[a.jsx("div",{className:"text-2xl font-bold",children:G}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:[a.jsx(t,{className:"w-3 h-3"}),a.jsxs("span",{children:[H," available"]})]})]})]}),a.jsxs(d,{children:[a.jsx(x,{className:"pb-3",children:a.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"In Use"})}),a.jsxs(o,{children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L}),a.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[G>0?Math.round(L/G*100):0,"% utilization"]})]})]}),a.jsxs(d,{children:[a.jsx(x,{className:"pb-3",children:a.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Maintenance Due"})}),a.jsxs(o,{children:[a.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:J}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-600 mt-1",children:[a.jsx(l,{className:"w-3 h-3"}),k," overdue"]})]})]}),a.jsxs(d,{children:[a.jsx(x,{className:"pb-3",children:a.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Certifications"})}),a.jsxs(o,{children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:K}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-600 mt-1",children:[a.jsx(l,{className:"w-3 h-3"}),Q," expired"]})]})]})]}),a.jsxs(h,{value:P,onValueChange:R,className:"space-y-6",children:[a.jsxs(j,{className:"grid w-full grid-cols-4",children:[a.jsx(u,{value:"overview",children:"Overview"}),a.jsx(u,{value:"maintenance",children:"Maintenance"}),a.jsx(u,{value:"certifications",children:"Certifications"}),a.jsx(u,{value:"utilization",children:"Utilization"})]}),a.jsxs(p,{value:"overview",className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(d,{children:[a.jsxs(x,{children:[a.jsx(m,{children:"Equipment Status"}),a.jsx(v,{children:"Current availability and deployment"})]}),a.jsxs(o,{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),a.jsx("span",{className:"text-sm",children:"Available"})]}),a.jsx("span",{className:"font-semibold",children:H})]}),a.jsx(N,{value:H/G*100,className:"h-2"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),a.jsx("span",{className:"text-sm",children:"In Use"})]}),a.jsx("span",{className:"font-semibold",children:L})]}),a.jsx(N,{value:L/G*100,className:"h-2"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),a.jsx("span",{className:"text-sm",children:"Maintenance"})]}),a.jsx("span",{className:"font-semibold",children:V})]}),a.jsx(N,{value:V/G*100,className:"h-2"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),a.jsx("span",{className:"text-sm",children:"Rental"})]}),a.jsx("span",{className:"font-semibold",children:W})]}),a.jsx(N,{value:W/G*100,className:"h-2"})]})]}),a.jsxs(d,{children:[a.jsxs(x,{children:[a.jsx(m,{children:"Equipment Types"}),a.jsx(v,{children:"Fleet composition"})]}),a.jsx(o,{children:a.jsx("div",{className:"space-y-3",children:Object.entries(e.reduce((e,s)=>(e[s.equipment_type]=(e[s.equipment_type]||0)+1,e),{})).sort(([,e],[,s])=>s-e).slice(0,6).map(([e,s])=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-sm capitalize",children:e.replace("_"," ")}),a.jsx("span",{className:"font-semibold",children:s})]}),a.jsx(N,{value:s/G*100,className:"h-2"})]},e))})})]})]}),a.jsxs(d,{children:[a.jsxs(x,{children:[a.jsx(m,{children:"Equipment Inventory"}),a.jsx(v,{children:"All heavy equipment with current status"})]}),a.jsx(o,{children:a.jsxs(g,{children:[a.jsx(b,{children:a.jsxs(y,{children:[a.jsx(w,{children:"Asset Tag"}),a.jsx(w,{children:"Equipment"}),a.jsx(w,{children:"Type"}),a.jsx(w,{children:"Engine Hours"}),a.jsx(w,{children:"Status"}),a.jsx(w,{children:"Location"})]})}),a.jsx(_,{children:0===e.length?a.jsx(y,{children:a.jsx(q,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No equipment data available"})}):e.map(e=>{return a.jsxs(y,{children:[a.jsx(q,{className:"font-mono text-sm font-medium",children:e.asset_tag}),a.jsx(q,{className:"font-medium",children:e.asset_name}),a.jsx(q,{className:"capitalize",children:e.equipment_type?.replace("_"," ")}),a.jsxs(q,{children:[parseFloat(e.engine_hours?.toString()||"0").toFixed(1)," hrs"]}),a.jsx(q,{children:a.jsx(f,{className:(s=e.availability_status,{available:"bg-green-100 text-green-700",in_use:"bg-blue-100 text-blue-700",maintenance:"bg-yellow-100 text-yellow-700",down:"bg-red-100 text-red-700",rental:"bg-purple-100 text-purple-700"}[s]||"bg-gray-100 text-gray-700"),variant:"secondary",children:e.availability_status})}),a.jsx(q,{className:"text-sm text-muted-foreground",children:e.current_job_site||"-"})]},e.id);var s})})]})})]})]}),a.jsx(p,{value:"maintenance",className:"space-y-6",children:(k>0||J>0)&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[k>0&&a.jsxs(d,{className:"border-red-200 bg-red-50",children:[a.jsx(x,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(l,{className:"w-5 h-5 text-red-600"}),a.jsx(m,{className:"text-red-700",children:"Overdue Maintenance"})]})}),a.jsxs(o,{children:[a.jsx("div",{className:"text-3xl font-bold text-red-700",children:k}),a.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Require immediate attention"})]})]}),J>0&&a.jsxs(d,{className:"border-yellow-200 bg-yellow-50",children:[a.jsx(x,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"w-5 h-5 text-yellow-600"}),a.jsx(m,{className:"text-yellow-700",children:"Upcoming Maintenance"})]})}),a.jsxs(o,{children:[a.jsx("div",{className:"text-3xl font-bold text-yellow-700",children:J}),a.jsx("p",{className:"text-sm text-yellow-600 mt-1",children:"Scheduled within 30 days or 50 hours"})]})]})]})}),a.jsx(p,{value:"certifications",className:"space-y-6"}),a.jsx(p,{value:"utilization",className:"space-y-6"})]})]})}import{r as s,j as a,b6 as t,C as l,as as i}from"./react-core-hQu9tqS1.js";import{t as n}from"./index-savvei9t.js";import{o as r,p as c,C as d,d as x,e as m,f as o,T as h,a as j,b as u,c as p,i as v,P as N,B as f}from"./index-BDwglPMF.js";import{T as g,a as b,b as y,c as w,d as _,e as q}from"./table-_lE51wjz.js";import{i as S}from"./responses-Dn12yLoR.js";import"./lazy-modules-Bs19xeuI.js";import"./form-vendor-DKCvS-hL.js";import"./chart-vendor-DWRb53_H.js";import"./utils-vendor-Bojdf5C8.js";import"./mui-core-BKffG9O1.js";import"./react-router-cBrq_s0x.js";import"./query-vendor--Fe2N4Al.js";import"./three-helpers-DedzJcO9.js";import"./three-core-ZrcxJ5g9.js";import"./three-react-B1s7Iy2r.js";import"./ui-radix-C-X5Qx_8.js";import"./ui-dialogs-C2yTnBPV.js";import"./animation-vendor-Cf_i_fm0.js";import"./date-vendor-npJ7nI92.js";import"./ui-menus--48tEbqQ.js";export{e as EquipmentDashboard};
