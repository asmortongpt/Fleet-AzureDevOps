function e(){const[e,I]=s.useState([]),[L,P]=s.useState("fleet-ops"),[q,D]=s.useState(!1),[B,G]=s.useState({subject:"",content:"",mentions:[]}),H=[{id:"fleet-ops",name:"Fleet Operations",unread:3},{id:"maintenance",name:"Maintenance Team",unread:1},{id:"management",name:"Fleet Management",unread:0},{id:"alerts",name:"Critical Alerts",unread:2}],Q=(e||[]).filter(e=>e.channelId===L);return a.jsxs("div",{className:"h-[calc(100vh-12rem)] flex gap-6",children:[a.jsxs("div",{className:"w-64 space-y-4",children:[a.jsxs(l,{children:[a.jsx(m,{children:a.jsxs(o,{className:"flex items-center gap-2",children:[a.jsx(t,{className:"w-5 h-5"}),"Channels"]})}),a.jsx(d,{className:"space-y-2 p-3",children:H.map(e=>a.jsxs(j,{variant:L===e.id?"secondary":"ghost",className:"w-full justify-between",onClick:()=>P(e.id),children:[a.jsxs("span",{className:"text-sm",children:["# ",e.name]}),e.unread>0&&a.jsx(x,{variant:"default",className:"ml-2",children:e.unread})]},e.id))})]}),a.jsxs(l,{children:[a.jsx(m,{className:"pb-3",children:a.jsx(o,{className:"text-sm",children:"Quick Actions"})}),a.jsxs(d,{className:"space-y-2 p-3",children:[a.jsxs(j,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",onClick:()=>(async e=>{try{const s=await O.createTeamsNotification("maintenance-team","maintenance","Maintenance Alert",`A ${e} priority maintenance issue requires attention.`,e);I(e=>[...e||[],s]),r.success("Notification sent to maintenance team")}catch(s){r.error("Failed to send notification")}})("urgent"),children:[a.jsx(n,{className:"w-4 h-4"}),"Alert Team"]}),a.jsxs(h,{open:q,onOpenChange:D,children:[a.jsx(u,{asChild:!0,children:a.jsxs(j,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",children:[a.jsx(i,{className:"w-4 h-4"}),"Compose"]})}),a.jsxs(p,{children:[a.jsxs(f,{children:[a.jsx(g,{children:"Post to Teams Channel"}),a.jsx(N,{children:"Send a message to the selected channel"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(C,{htmlFor:"message-subject",children:"Subject"}),a.jsx(v,{id:"message-subject",value:B.subject,onChange:e=>G({...B,subject:e.target.value}),placeholder:"Message subject"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(C,{htmlFor:"message-content",children:"Message"}),a.jsx(z,{id:"message-content",value:B.content,onChange:e=>G({...B,content:e.target.value}),placeholder:"Type your message...",rows:6})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(C,{htmlFor:"channel-select",children:"Channel"}),a.jsxs(S,{value:L,onValueChange:P,children:[a.jsx(M,{id:"channel-select",children:a.jsx(T,{})}),a.jsx(F,{children:H.map(e=>a.jsxs(k,{value:e.id,children:["# ",e.name]},e.id))})]})]})]}),a.jsxs(y,{children:[a.jsx(j,{variant:"outline",onClick:()=>D(!1),children:"Cancel"}),a.jsxs(j,{onClick:async()=>{if(B.subject&&B.content)try{const e=await O.sendTeamsMessage(L,B.subject,B.content,B.mentions.join(", "));I(s=>[...s||[],e]),r.success("Message posted to Teams"),D(!1),G({subject:"",content:"",mentions:[]})}catch(e){r.error("Failed to send message")}else r.error("Please fill in subject and message")},children:[a.jsx(i,{className:"w-4 h-4 mr-2"}),"Send Message"]})]})]})]})]})]})]}),a.jsxs(l,{className:"flex-1 flex flex-col",children:[a.jsxs(m,{children:[a.jsxs(o,{className:"flex items-center justify-between",children:[a.jsxs("span",{children:["# ",H.find(e=>e.id===L)?.name]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground font-normal",children:[a.jsx(c,{className:"w-4 h-4"}),a.jsx("span",{children:"12 members"})]})]}),a.jsx(b,{children:"Team collaboration and notifications"})]}),a.jsx(d,{className:"flex-1 flex flex-col p-0",children:a.jsx(w,{className:"flex-1 px-6",children:0===Q.length?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[a.jsx("div",{className:"p-4 bg-muted rounded-full mb-4",children:a.jsx(t,{className:"w-12 h-12 text-muted-foreground"})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No messages yet"}),a.jsx("p",{className:"text-muted-foreground max-w-md",children:"Start the conversation by posting your first message to this channel."}),a.jsx(j,{className:"mt-4",onClick:()=>D(!0),children:"Post Message"})]}):a.jsx("div",{className:"space-y-4 py-4",children:Q.map(e=>a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-semibold",children:e.author?.charAt(0)??"?"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"font-semibold text-sm",children:e.author}),a.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(e.timestamp).toLocaleString()})]}),e.subject&&a.jsx("div",{className:"font-medium mb-1",children:e.subject}),a.jsx("div",{className:"text-sm whitespace-pre-wrap",children:e.content}),e.reactions&&e.reactions.length>0&&a.jsx("div",{className:"flex gap-2 mt-2",children:e.reactions.map((e,s)=>a.jsxs(x,{variant:"outline",className:"text-xs",children:[e.emoji," ",e.count]},s))})]})]}),a.jsx(A,{})]},e.id))})})})]})]})}import{r as s,j as a,H as t,ai as n,cb as i,z as c}from"./react-core-hQu9tqS1.js";import{t as r}from"./index-savvei9t.js";import{C as l,d as m,e as o,f as d,h as j,B as x,D as h,t as u,j as p,k as f,l as g,m as N,I as v,n as y,i as b,S as w}from"./index-BDwglPMF.js";import{L as C}from"./label-C9sYRYKW.js";import{S,a as M,b as T,c as F,d as k}from"./select-Bmd3s7f4.js";import{S as A}from"./separator-Dey2K2dP.js";import{T as z}from"./textarea-BOBjqKNu.js";import{m as O}from"./msOfficeIntegration--qOuKPN6.js";import"./lazy-modules-Bs19xeuI.js";import"./form-vendor-DKCvS-hL.js";import"./chart-vendor-DWRb53_H.js";import"./utils-vendor-Bojdf5C8.js";import"./mui-core-BKffG9O1.js";import"./react-router-cBrq_s0x.js";import"./query-vendor--Fe2N4Al.js";import"./three-helpers-DedzJcO9.js";import"./three-core-ZrcxJ5g9.js";import"./three-react-B1s7Iy2r.js";import"./ui-radix-C-X5Qx_8.js";import"./ui-dialogs-C2yTnBPV.js";import"./animation-vendor-Cf_i_fm0.js";import"./date-vendor-npJ7nI92.js";import"./ui-menus--48tEbqQ.js";export{e as TeamsIntegration};
