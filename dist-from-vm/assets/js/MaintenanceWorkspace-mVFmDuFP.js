function e({}){const[e,n]=s.useState(null),[d,m]=s.useState("facility"),[o,x]=s.useState("all"),y=s.useMemo(()=>{},[]),[S,k]=s.useState(y?"map":"tactical"),{data:C=[]}=u(),{data:M=[]}=j(),{data:O=[]}=p(),{data:V=[]}=v(),{vehicles:P,isConnected:A}=z({enabled:!0,initialVehicles:C}),$=P.length>0?P:C,G=s.useMemo(()=>$.filter(e=>"all"===o||("service"===o?"service"===e.status:"alerts"===o?e.alerts&&e.alerts.length>0:"due"!==o||e.nextService&&500>Number(e.nextService)-(e.mileage||0))),[$,o]),H=s.useCallback(e=>{const s=$.find(s=>s.id===e);s&&(n({type:"vehicle",data:s}),m("vehicle"))},[$]),Q=s.useMemo(()=>({inService:$.filter(e=>"service"===e.status).length,alertsPending:$.filter(e=>e.alerts&&e.alerts.length>0).length,serviceDue:$.filter(e=>e.nextService&&500>Number(e.nextService)-(e.mileage||0)).length,workOrdersPending:O.filter(e=>"pending"===e.status).length}),[$,O]);return a.jsxs("div",{className:"h-screen grid grid-cols-[1fr_400px]","data-testid":"maintenance-workspace",children:[a.jsxs("div",{className:"relative h-full",children:[a.jsx(h,{vehicles:G,facilities:M,height:"100vh",onVehicleSelect:H,showLegend:!0,enableRealTime:A,forceSimulatedView:"tactical"===S}),a.jsxs("div",{className:"absolute top-4 left-4 bg-background/95 backdrop-blur rounded-lg shadow-lg z-10 flex gap-2",children:[a.jsxs("div",{className:"p-1 bg-muted rounded-md flex",children:[a.jsx(N,{variant:"map"===S?"secondary":"ghost",size:"sm",className:"h-8 px-3",onClick:()=>k("map"),children:"Map"}),a.jsxs(N,{variant:"tactical"===S?"secondary":"ghost",size:"sm",className:"h-8 px-3",onClick:()=>k("tactical"),children:[a.jsx(t,{className:"h-4 w-4 mr-2"}),"Tactical"]})]}),a.jsx("div",{className:"p-1",children:a.jsxs(F,{value:o,onValueChange:x,children:[a.jsx(W,{className:"w-48","data-testid":"maint-filter",children:a.jsx(I,{placeholder:"Filter vehicles"})}),a.jsxs(D,{children:[a.jsx(q,{value:"all",children:"All Vehicles"}),a.jsx(q,{value:"service",children:"In Service"}),a.jsx(q,{value:"alerts",children:"With Alerts"}),a.jsx(q,{value:"due",children:"Service Due Soon"})]})]})})]}),a.jsx("div",{className:"absolute bottom-4 left-4 right-[420px] bg-background/95 backdrop-blur rounded-lg shadow-lg p-3 z-10",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(l,{className:"h-4 w-4 text-muted-foreground"}),a.jsxs("span",{className:"text-sm",children:["In Service: ",Q.inService]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(i,{className:"h-4 w-4 text-yellow-500"}),a.jsxs("span",{className:"text-sm",children:["Alerts: ",Q.alertsPending]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(r,{className:"h-4 w-4 text-red-500"}),a.jsxs("span",{className:"text-sm",children:["Due Soon: ",Q.serviceDue]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(c,{className:"h-4 w-4 text-muted-foreground"}),a.jsxs("span",{className:"text-sm",children:["Work Orders: ",Q.workOrdersPending]})]})]})})})]}),a.jsx("div",{className:"border-l h-full",children:a.jsxs(f,{defaultValue:"facility",value:d,onValueChange:m,className:"w-full h-full",children:[a.jsxs(g,{className:"grid w-full grid-cols-4",children:[a.jsx(w,{value:"facility",children:"Facilities"}),a.jsx(w,{value:"vehicle",children:"Vehicle"}),a.jsx(w,{value:"work",children:"Work Orders"}),a.jsx(w,{value:"parts",children:"Parts"})]}),a.jsx(b,{value:"facility",className:"h-[calc(100vh-48px)] mt-0",children:a.jsx(T,{facilities:M,onFacilitySelect:e=>{n({type:"facility",data:e}),m("facility")}})}),a.jsx(b,{value:"vehicle",className:"h-[calc(100vh-48px)] mt-0",children:a.jsx(L,{vehicle:"vehicle"===e?.type?e.data:null,_maintenanceHistory:null})}),a.jsx(b,{value:"work",className:"h-[calc(100vh-48px)] mt-0",children:a.jsx(_,{workOrders:O,onWorkOrderSelect:e=>{n({type:"workOrder",data:e}),m("work")}})}),a.jsx(b,{value:"parts",className:"h-[calc(100vh-48px)] mt-0",children:a.jsx(R,{_parts:null})})]})})]})}import{r as s,j as a,db as t,O as l,I as i,Y as r,W as c,aE as n,a4 as d,aQ as m,aC as o,bQ as x}from"./react-core-hQu9tqS1.js";import{P as h}from"./ProfessionalFleetMap-DPQoniTv.js";import{r as u,x as j,V as p,Y as v,h as N,T as f,a as g,b as w,c as b,S as y,C as S,f as k,B as C,d as M,e as O,q as V,P}from"./index-BDwglPMF.js";import{S as F,a as W,b as I,c as D,d as q}from"./select-Bmd3s7f4.js";import{u as z}from"./useVehicleTelemetry-DuT1yBRR.js";import{n as A}from"./index-B79owE5d.js";import"./lazy-modules-Bs19xeuI.js";import"./form-vendor-DKCvS-hL.js";import"./chart-vendor-DWRb53_H.js";import"./utils-vendor-Bojdf5C8.js";import"./mui-core-BKffG9O1.js";import"./MaintenanceRequestDialog-Rxhi54iS.js";import"./index-savvei9t.js";import"./label-C9sYRYKW.js";import"./ui-radix-C-X5Qx_8.js";import"./three-helpers-DedzJcO9.js";import"./three-core-ZrcxJ5g9.js";import"./three-react-B1s7Iy2r.js";import"./textarea-BOBjqKNu.js";import"./GoogleMap-BAYip6gy.js";import"./switch-9MiV1CpI.js";import"./react-router-cBrq_s0x.js";import"./query-vendor--Fe2N4Al.js";import"./ui-dialogs-C2yTnBPV.js";import"./animation-vendor-Cf_i_fm0.js";import"./date-vendor-npJ7nI92.js";import"./ui-menus--48tEbqQ.js";const T=({facilities:e,onFacilitySelect:s})=>e&&0!==e.length?a.jsx(y,{className:"h-full",children:a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Maintenance Facilities"}),e.map(e=>a.jsx(S,{className:"cursor-pointer hover:bg-accent transition-colors",onClick:()=>s(e),"data-testid":`facility-card-${e.id}`,children:a.jsx(k,{className:"p-3",children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(n,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"font-medium",children:e.name})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.address}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx(C,{variant:"operational"===e.status?"default":"destructive",children:e.status}),a.jsxs("span",{className:"text-xs text-muted-foreground",children:["Capacity: ",e.capacity," vehicles"]})]})]})})})},e.id))]})}):a.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"No facilities available"}),L=({vehicle:e})=>{if(!e)return a.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Select a vehicle on the map to view maintenance details"});const s=e.nextService?Math.floor((Number(e.nextService)-(e.mileage||0)||0)/50):null;return a.jsx(y,{className:"h-full",children:a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold",children:[e.year," ",e.make," ",e.model]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.licensePlate," â€¢ ",e.vin]})]}),a.jsxs(S,{children:[a.jsx(M,{className:"pb-3",children:a.jsxs(O,{className:"text-sm font-medium flex items-center gap-2",children:[a.jsx(c,{className:"h-4 w-4"}),"Maintenance Status"]})}),a.jsxs(k,{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:"Current Mileage"}),a.jsxs("span",{className:"font-medium",children:[e.mileage?.toLocaleString()," mi"]})]}),e.nextService&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm",children:"Next Service"}),a.jsxs("span",{className:"font-medium",children:[e.nextService.toLocaleString()," mi"]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{children:"Service Due In"}),a.jsxs("span",{className:V("font-medium",s&&7>s?"text-red-500":"text-green-500"),children:[Number(e.nextService)-(e.mileage||0)||0," mi"]})]}),a.jsx(P,{value:Number(e.nextService)>0?(e.mileage||0)/Number(e.nextService)*100:0,className:"h-2"})]})]}),e.alerts&&e.alerts.length>0&&a.jsxs("div",{className:"mt-3 pt-3 border-t space-y-2",children:[a.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[a.jsx(i,{className:"h-4 w-4 text-yellow-500"}),"Active Alerts"]}),e.alerts.map((e,s)=>a.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[a.jsx(d,{className:"h-4 w-4 text-yellow-500 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:e})]},s))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(N,{className:"w-full",children:[a.jsx(r,{className:"h-4 w-4 mr-2"}),"Schedule Service"]}),a.jsxs(N,{variant:"outline",className:"w-full hover:bg-red-500/10 hover:text-red-500 hover:border-red-500/50 transition-colors",onClick:()=>{A.success("Maintenance request submitted",{duration:3e3,position:"top-center"})},children:[a.jsx(c,{className:"h-4 w-4 mr-2"}),"Request Maintenance"]}),a.jsx(N,{variant:"outline",className:"w-full",children:"View Service History"})]})]})})},_=({workOrders:e,onWorkOrderSelect:s})=>{const t=e=>{switch(e){case"completed":return a.jsx(x,{className:"h-4 w-4 text-green-500"});case"in_progress":return a.jsx(o,{className:"h-4 w-4 text-blue-500"});case"pending":return a.jsx(d,{className:"h-4 w-4 text-yellow-500"});default:return a.jsx(d,{className:"h-4 w-4 text-gray-500"})}},l=e=>{switch(e){case"critical":return"destructive";case"high":return"default";case"medium":return"secondary";default:return"outline"}};return a.jsx(y,{className:"h-full",children:a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Work Orders"}),e&&e.length>0?e.map(e=>a.jsx(S,{className:"cursor-pointer hover:bg-accent transition-colors",onClick:()=>s(e),"data-testid":`work-order-${e.id}`,children:a.jsx(k,{className:"p-3",children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t(e.status),a.jsx("span",{className:"font-medium",children:e.title||e.description})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.vehicleId&&`Vehicle: ${e.vehicleId}`}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx(C,{variant:l(e.priority),children:e.priority}),a.jsx(C,{variant:"outline",children:e.status})]})]})})})},e.id)):a.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No work orders available"}),a.jsxs(N,{className:"w-full mt-4",children:[a.jsx(c,{className:"h-4 w-4 mr-2"}),"Create Work Order"]})]})})},R=({})=>a.jsx(y,{className:"h-full",children:a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Parts Inventory"}),a.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[a.jsx(m,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),a.jsx("p",{children:"Parts inventory management"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"Maintenance schedules and work orders are displayed in the main workspace."}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Use the tabs above to navigate between different views."})]})]})]})});export{e as MaintenanceWorkspace};
