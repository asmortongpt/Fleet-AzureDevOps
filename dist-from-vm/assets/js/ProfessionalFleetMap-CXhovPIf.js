function e({onVehicleSelect:e,children:o}){const{data:h,isLoading:m,error:u}=n(),[x,g]=s.useState([]),[f,b]=s.useState(10),[p,v]=s.useState(null),j=s.useRef(null);s.useEffect(()=>{if(!m)if(u||!h||Array.isArray(h)&&0===h.length){const e=d(50);g(e)}else Array.isArray(h)&&g(h)},[h,m,u]),s.useEffect(()=>{const e=setTimeout(()=>{if(0===x.length){const e=d(50);g(e)}},3e3);return()=>clearTimeout(e)},[x.length]);const N=x.filter(e=>null!=(e.latitude??e.location?.lat)&&null!=(e.longitude??e.location?.lng)),w=e=>{switch(e){case"active":return"bg-emerald-500 shadow-emerald-500/50";case"maintenance":case"service":return"bg-amber-500 shadow-amber-500/50";case"inactive":return"bg-slate-400 shadow-slate-400/50";default:return"bg-blue-500 shadow-blue-500/50"}};return t.jsxs("div",{className:"w-full h-full relative overflow-hidden","data-testid":"professional-fleet-map",children:[t.jsxs("div",{ref:j,className:"absolute inset-0 bg-gradient-to-br from-slate-800 via-slate-900 to-slate-950",style:{backgroundImage:"\n            linear-gradient(rgba(71, 85, 105, 0.1) 1px, transparent 1px),\n            linear-gradient(90deg, rgba(71, 85, 105, 0.1) 1px, transparent 1px)\n          ",backgroundSize:`${4*f}px ${4*f}px`},children:[t.jsx("div",{className:"absolute inset-0 opacity-20",children:t.jsxs("svg",{className:"w-full h-full",children:[t.jsx("defs",{children:t.jsx("pattern",{id:"grid",width:"100",height:"100",patternUnits:"userSpaceOnUse",children:t.jsx("path",{d:"M 100 0 L 0 0 0 100",fill:"none",stroke:"rgba(148, 163, 184, 0.3)",strokeWidth:"0.5"})})}),t.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid)"})]})}),N.map((s,l)=>{const r=((e,s)=>{const t=(90-(e.latitude??e.location?.lat??0))/180*100,a=23*s%20-10;return{left:Math.max(5,Math.min(90,30+((e.longitude??e.location?.lng??0)+180)/360*100%60+(37*s%20-10))),top:Math.max(5,Math.min(90,20+t%60+a))}})(s,l),i=p===s.id;return t.jsxs("div",{className:"absolute cursor-pointer transition-all duration-300 "+(i?"z-20 scale-125":"z-10 hover:scale-110 hover:z-15"),style:{left:`${r.left}%`,top:`${r.top}%`,transform:"translate(-50%, -50%)"},onClick:()=>(s=>{v(s.id),e?.(s.id)})(s),"data-testid":`map-marker-${s.id}`,children:[t.jsxs("div",{className:"relative",children:["active"===s.status&&t.jsx("div",{className:`absolute inset-0 rounded-full ${w(s.status)} animate-ping opacity-40`}),t.jsx("div",{className:`relative p-2 rounded-full shadow-lg ${w(s.status)} ${i?"ring-2 ring-white ring-offset-2 ring-offset-slate-900":""}`,children:t.jsx(a,{className:"h-4 w-4 text-white",style:{transform:`rotate(${45*l%360}deg)`}})})]}),i&&t.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 px-2 py-1 bg-white rounded shadow-lg text-xs font-medium text-slate-800 whitespace-nowrap",children:s.vehicleNumber||`Vehicle ${s.id.slice(0,6)}`})]},s.id)}),t.jsxs("div",{className:"absolute bottom-4 left-4 z-20 bg-slate-900/80 backdrop-blur-md rounded-lg p-3 border border-slate-700",children:[t.jsx("div",{className:"text-xs font-semibold text-slate-300 mb-2",children:"Fleet Status"}),t.jsxs("div",{className:"flex flex-col gap-1.5 text-xs text-slate-400",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-emerald-500"}),t.jsxs("span",{children:["Active (",N.filter(e=>"active"===e.status).length,")"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500"}),t.jsxs("span",{children:["Maintenance (",N.filter(e=>"maintenance"===e.status||"service"===e.status).length,")"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-400"}),t.jsxs("span",{children:["Inactive (",N.filter(e=>"inactive"===e.status).length,")"]})]})]})]}),t.jsxs("div",{className:"absolute top-4 left-4 z-20 bg-slate-900/80 backdrop-blur-md rounded-lg px-4 py-2 border border-slate-700",children:[t.jsx("span",{className:"text-sm font-semibold text-emerald-400",children:N.length}),t.jsx("span",{className:"text-sm text-slate-400 ml-1",children:"vehicles tracked"})]})]}),t.jsxs("div",{className:"absolute top-4 right-4 z-20 flex flex-col gap-2",children:[t.jsx(c,{size:"icon",variant:"secondary",className:"bg-slate-900/80 border-slate-700 hover:bg-slate-800",onClick:()=>b(Math.min(f+2,24)),"data-testid":"map-zoom-in",children:t.jsx(l,{className:"h-4 w-4 text-slate-300"})}),t.jsx(c,{size:"icon",variant:"secondary",className:"bg-slate-900/80 border-slate-700 hover:bg-slate-800",onClick:()=>b(Math.max(f-2,4)),"data-testid":"map-zoom-out",children:t.jsx(r,{className:"h-4 w-4 text-slate-300"})}),t.jsx(c,{size:"icon",variant:"secondary",className:"bg-slate-900/80 border-slate-700 hover:bg-slate-800","data-testid":"map-locate",children:t.jsx(i,{className:"h-4 w-4 text-slate-300"})})]}),o]})}import{r as s,j as t,c8 as a,cs as l,ct as r,cu as i}from"./react-core-hQu9tqS1.js";import{r as n,M as d,h as c}from"./index-BDwglPMF.js";export{e as P};
