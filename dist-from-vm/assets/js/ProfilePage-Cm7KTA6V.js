function e(){const[e,h]=s(A),[p,u]=a.useState(!1),[M,B]=a.useState(null),[R,E]=a.useState(null),[$,z]=a.useState(!e),[G,q]=a.useState(null);a.useEffect(()=>{e||(z(!0),q(null),(async()=>{try{const e=await fetch("/api/auth/me");if(!e.ok)throw new C(`Authentication failed: ${e.statusText}`);return await e.json()}catch(e){if(e instanceof C)throw e;throw new C("Network error occurred while fetching current user.")}})().then(e=>{h(e),z(!1)}).catch(e=>{N.error("Failed to fetch current user:",e),q("Unable to load profile. Please ensure you are logged in and the server is available."),z(!1)}))},[e,h]);const O=e,{register:V,handleSubmit:Y,reset:J,formState:{errors:H,isDirty:Z}}=o({resolver:x(D),defaultValues:{displayName:O?.displayName||"",firstName:O?.firstName||"",lastName:O?.lastName||"",email:O?.email||"",phone:O?.phone||"",jobTitle:O?.jobTitle||"",department:O?.department||"",bio:O?.bio||"",linkedin:O?.socialLinks?.linkedin||"",github:O?.socialLinks?.github||"",twitter:O?.socialLinks?.twitter||""}}),_=async e=>{try{await new Promise(e=>setTimeout(e,1e3)),O&&h({...O,displayName:e.displayName,firstName:e.firstName,lastName:e.lastName,email:e.email,phone:e.phone,jobTitle:e.jobTitle,department:e.department,bio:e.bio,socialLinks:{linkedin:e.linkedin,github:e.github,twitter:e.twitter},avatar:R||O.avatar,updatedAt:(new Date).toISOString()}),j.success("Profile updated successfully"),u(!1),B(null),E(null)}catch(s){j.error("Failed to update profile"),N.error("Profile update error:",s)}};return $?t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):t.jsxs("div",O?{className:"container mx-auto p-6 max-w-4xl",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"My Profile"}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your personal information"})]}),p?t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(f,{variant:"outline",onClick:()=>{J(),u(!1),B(null),E(null)},children:[t.jsx(r,{className:"mr-2 h-4 w-4"}),"Cancel"]}),t.jsxs(f,{onClick:Y(_),disabled:!Z&&!M,children:[t.jsx(l,{className:"mr-2 h-4 w-4"}),"Save Changes"]})]}):t.jsxs(f,{onClick:()=>u(!0),children:[t.jsx(i,{className:"mr-2 h-4 w-4"}),"Edit Profile"]})]}),t.jsxs("form",{onSubmit:Y(_),className:"space-y-6",children:[t.jsxs(b,{children:[t.jsxs(g,{children:[t.jsx(v,{children:"Profile Picture"}),t.jsx(y,{children:"Upload a profile picture (max 5MB)"})]}),t.jsx(w,{children:t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsxs(k,{className:"h-24 w-24",children:[t.jsx(F,{src:R||O.avatar,alt:O.displayName}),t.jsx(S,{className:"text-2xl",children:O?.firstName&&O?.lastName?`${O.firstName[0]}${O.lastName[0]}`.toUpperCase():O?.displayName?.slice(0,2).toUpperCase()||"U"})]}),p&&t.jsxs("div",{children:[t.jsxs(T,{htmlFor:"avatar",className:"cursor-pointer",children:[t.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-secondary rounded-md hover:bg-secondary/80 transition-colors",children:[t.jsx(n,{className:"h-4 w-4"}),t.jsx("span",{className:"text-sm font-medium",children:"Upload Photo"})]}),t.jsx(L,{id:"avatar",type:"file",accept:"image/*",onChange:e=>{const s=e.target.files?.[0];if(s){if(s.size>5242880)return void j.error("Image must be less than 5MB");B(s);const e=new FileReader;e.onloadend=()=>{E(e.result)},e.readAsDataURL(s)}},className:"hidden"})]}),t.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"JPG, PNG or GIF (max 5MB)"})]})]})})]}),t.jsxs(b,{children:[t.jsxs(g,{children:[t.jsx(v,{children:"Personal Information"}),t.jsx(y,{children:"Your basic profile information"})]}),t.jsxs(w,{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(T,{htmlFor:"firstName",children:"First Name"}),t.jsx(L,{id:"firstName",...V("firstName"),disabled:!p,className:p?"":"bg-muted"}),H.firstName&&t.jsx("p",{className:"text-sm text-destructive",children:H.firstName.message})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(T,{htmlFor:"lastName",children:"Last Name"}),t.jsx(L,{id:"lastName",...V("lastName"),disabled:!p,className:p?"":"bg-muted"}),H.lastName&&t.jsx("p",{className:"text-sm text-destructive",children:H.lastName.message})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(T,{htmlFor:"displayName",children:"Display Name"}),t.jsx(L,{id:"displayName",...V("displayName"),disabled:!p,className:p?"":"bg-muted"}),H.displayName&&t.jsx("p",{className:"text-sm text-destructive",children:H.displayName.message})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(T,{htmlFor:"email",className:"flex items-center gap-2",children:["Email",O.emailVerified&&t.jsxs(P,{variant:"secondary",className:"text-xs",children:[t.jsx(l,{className:"h-3 w-3 mr-1"}),"Verified"]})]}),t.jsx(L,{id:"email",type:"email",...V("email"),disabled:!p,className:p?"":"bg-muted"}),H.email&&t.jsx("p",{className:"text-sm text-destructive",children:H.email.message})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(T,{htmlFor:"phone",children:"Phone Number"}),t.jsx(L,{id:"phone",type:"tel",placeholder:"+1 (555) 000-0000",...V("phone"),disabled:!p,className:p?"":"bg-muted"}),H.phone&&t.jsx("p",{className:"text-sm text-destructive",children:H.phone.message})]})]})]}),t.jsxs(b,{children:[t.jsxs(g,{children:[t.jsx(v,{children:"Professional Information"}),t.jsx(y,{children:"Your job title and department"})]}),t.jsxs(w,{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(T,{htmlFor:"jobTitle",children:"Job Title"}),t.jsx(L,{id:"jobTitle",...V("jobTitle"),disabled:!p,className:p?"":"bg-muted"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(T,{htmlFor:"department",children:"Department"}),t.jsx(L,{id:"department",...V("department"),disabled:!p,className:p?"":"bg-muted"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(T,{htmlFor:"bio",children:"Bio"}),t.jsx(I,{id:"bio",rows:4,placeholder:"Tell us about yourself...",...V("bio"),disabled:!p,className:p?"resize-none":"bg-muted resize-none"}),H.bio&&t.jsx("p",{className:"text-sm text-destructive",children:H.bio.message})]})]})]}),t.jsxs(b,{children:[t.jsxs(g,{children:[t.jsx(v,{children:"Social Links"}),t.jsx(y,{children:"Connect your social media profiles"})]}),t.jsxs(w,{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs(T,{htmlFor:"linkedin",className:"flex items-center gap-2",children:[t.jsx(d,{className:"h-4 w-4"}),"LinkedIn"]}),t.jsx(L,{id:"linkedin",type:"url",placeholder:"https://linkedin.com/in/username",...V("linkedin"),disabled:!p,className:p?"":"bg-muted"}),H.linkedin&&t.jsx("p",{className:"text-sm text-destructive",children:H.linkedin.message})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(T,{htmlFor:"github",className:"flex items-center gap-2",children:[t.jsx(m,{className:"h-4 w-4"}),"GitHub"]}),t.jsx(L,{id:"github",type:"url",placeholder:"https://github.com/username",...V("github"),disabled:!p,className:p?"":"bg-muted"}),H.github&&t.jsx("p",{className:"text-sm text-destructive",children:H.github.message})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(T,{htmlFor:"twitter",className:"flex items-center gap-2",children:[t.jsx(c,{className:"h-4 w-4"}),"Twitter"]}),t.jsx(L,{id:"twitter",type:"url",placeholder:"https://twitter.com/username",...V("twitter"),disabled:!p,className:p?"":"bg-muted"}),H.twitter&&t.jsx("p",{className:"text-sm text-destructive",children:H.twitter.message})]})]})]}),t.jsx(U,{}),t.jsxs(b,{children:[t.jsxs(g,{children:[t.jsx(v,{children:"Account Information"}),t.jsx(y,{children:"Account status and metadata"})]}),t.jsxs(w,{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-medium",children:"User ID"}),t.jsx("span",{className:"text-sm text-muted-foreground font-mono",children:O.id})]}),t.jsx(U,{}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-medium",children:"Status"}),t.jsx(P,{variant:"active"===O.status?"default":"invited"===O.status?"secondary":"destructive",children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})]}),t.jsx(U,{}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-medium",children:"Member Since"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(O.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),O.lastActive&&t.jsxs(t.Fragment,{children:[t.jsx(U,{}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-medium",children:"Last Active"}),t.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(O.lastActive).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})]})]})]}:{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[t.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:G||"Unable to load user profile. Please ensure you are logged in."}),t.jsx(f,{variant:"outline",onClick:()=>window.location.reload(),children:"Try Again"})]})}import{dx as s,r as a,j as t,aP as i,bs as r,bY as l,bu as n,dM as d,dN as m,dO as c}from"./react-core-hQu9tqS1.js";import{au as o,av as x,al as h,an as p,ao as u}from"./form-vendor-DKCvS-hL.js";import{n as j}from"./index-B79owE5d.js";import{p as N,h as f,C as b,d as g,e as v,i as y,f as w,Z as k,_ as F,$ as S,I as L,B as P}from"./index-BDwglPMF.js";import{L as T}from"./label-C9sYRYKW.js";import{S as U}from"./separator-Dey2K2dP.js";import{T as I}from"./textarea-BOBjqKNu.js";import{c as A}from"./reactive-state-BaSbv9rd.js";import"./lazy-modules-Bs19xeuI.js";import"./chart-vendor-DWRb53_H.js";import"./utils-vendor-Bojdf5C8.js";import"./mui-core-BKffG9O1.js";import"./react-router-cBrq_s0x.js";import"./query-vendor--Fe2N4Al.js";import"./three-helpers-DedzJcO9.js";import"./three-core-ZrcxJ5g9.js";import"./three-react-B1s7Iy2r.js";import"./ui-radix-C-X5Qx_8.js";import"./ui-dialogs-C2yTnBPV.js";import"./animation-vendor-Cf_i_fm0.js";import"./date-vendor-npJ7nI92.js";import"./ui-menus--48tEbqQ.js";class C extends Error{constructor(e){super(e),this.name="AppError"}}const D=h({displayName:p().min(2,"Name must be at least 2 characters").max(50),firstName:p().min(1,"First name is required").optional(),lastName:p().min(1,"Last name is required").optional(),email:p().email("Invalid email address"),phone:p().regex(/^\+?[1-9]\d{1,14}$/,"Invalid phone number").optional().or(u("")),jobTitle:p().optional(),department:p().optional(),bio:p().max(500,"Bio must be less than 500 characters").optional(),linkedin:p().url("Invalid URL").optional().or(u("")),github:p().url("Invalid URL").optional().or(u("")),twitter:p().url("Invalid URL").optional().or(u(""))});export{e as default};
