<!DOCTYPE html>
<html>
<head>
    <title>Clearing Cache...</title>
    <style>
        body { font-family: system-ui; padding: 40px; text-align: center; }
        .status { margin: 20px 0; font-size: 18px; }
        .btn { background: #1e40af; color: white; border: none; padding: 12px 24px; font-size: 16px; cursor: pointer; border-radius: 6px; }
    </style>
</head>
<body>
    <h1>üîÑ Cache Clearing Tool</h1>
    <div class="status" id="status">Clearing service worker and cache...</div>
    <button class="btn" onclick="location.href='/'">Return to App</button>

    <script>
        async function clearEverything() {
            const status = document.getElementById('status');

            try {
                // Unregister all service workers
                if ('serviceWorker' in navigator) {
                    const registrations = await navigator.serviceWorker.getRegistrations();
                    for (const registration of registrations) {
                        await registration.unregister();
                        console.log('Unregistered service worker:', registration.scope);
                    }
                    status.innerHTML += '<br>‚úÖ Service workers unregistered';
                }

                // Clear all caches
                if ('caches' in window) {
                    const cacheNames = await caches.keys();
                    for (const cacheName of cacheNames) {
                        await caches.delete(cacheName);
                        console.log('Deleted cache:', cacheName);
                    }
                    status.innerHTML += '<br>‚úÖ All caches cleared';
                }

                // Clear localStorage
                localStorage.clear();
                status.innerHTML += '<br>‚úÖ LocalStorage cleared';

                // Clear sessionStorage
                sessionStorage.clear();
                status.innerHTML += '<br>‚úÖ SessionStorage cleared';

                status.innerHTML += '<br><br>‚úÖ <strong>Cache cleared successfully!</strong><br>Click the button below to return to the app.';

            } catch (error) {
                console.error('Error clearing cache:', error);
                status.innerHTML = '‚ùå Error: ' + error.message;
            }
        }

        clearEverything();
    </script>
</body>
</html>
