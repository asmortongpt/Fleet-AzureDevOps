[0;36m
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                        ‚ïë
‚ïë     FLEET MANAGEMENT SYSTEM                            ‚ïë
‚ïë     PRODUCTION DEPLOYMENT                              ‚ïë
‚ïë                                                        ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
[0m
Version:    v1.0.20251222201147
Environment: PRODUCTION
Timestamp:  2025-12-23 01:11:47 UTC
Operator:   andrewmorton
Report:     deployment-report-20251222-201147.txt

[0;34m[INFO][0m Starting production deployment...

[0;35m[STEP][0m Checking prerequisites...
[0;32m[SUCCESS][0m All required tools are installed
[0;32m[SUCCESS][0m Logged in to Azure
[0;35m[STEP][0m Running pre-flight checks...

[0;35m========================================[0m
[0;35mFLEET MANAGEMENT - PRODUCTION PRE-FLIGHT CHECK[0m
[0;35m========================================[0m
Starting comprehensive pre-deployment validation...
Date: 2025-12-23 01:11:47 UTC
Report: preflight-report.txt


[0;35m========================================[0m
[0;35m1. Azure CLI Verification[0m
[0;35m========================================[0m
[0;32m[PASS][0m Azure CLI is installed
[0;32m[PASS][0m Logged in to Azure CLI
[0;34m[INFO][0m Active subscription: Azure subscription 1 (021415c2-2f52-4a73-ae77-f8363165a5e1)

[0;35m========================================[0m
[0;35m2. Azure Resources Verification[0m
[0;35m========================================[0m
[0;34m[INFO][0m Checking resource group: fleet-production-rg
[0;32m[PASS][0m Resource group exists: fleet-production-rg
[0;34m[INFO][0m Checking AKS cluster: fleet-aks-cluster
[0;32m[PASS][0m AKS cluster exists: fleet-aks-cluster
[0;32m[PASS][0m AKS cluster is in Succeeded state
[0;34m[INFO][0m AKS node count: 4
[0;32m[PASS][0m Sufficient nodes for production (>= 2)
[0;34m[INFO][0m Checking container registry: fleetappregistry
[0;31m[CRITICAL][0m Container registry not found: fleetappregistry
[0;34m[INFO][0m Checking Application Insights...
[1;33m[WARN][0m No Application Insights found (recommended for production)

[0;35m========================================[0m
[0;35m3. Database Connectivity[0m
[0;35m========================================[0m
[0;32m[PASS][0m DATABASE_URL is set
[0;34m[INFO][0m Getting AKS credentials...
[0;32m[PASS][0m Got AKS credentials
[0;34m[INFO][0m Testing database connection via pod...
[0;31m[FAIL][0m Cannot connect to database

[0;35m========================================[0m
[0;35m4. Azure AD Configuration[0m
[0;35m========================================[0m
[0;32m[PASS][0m AZURE_AD_CLIENT_ID is set
[0;32m[PASS][0m AZURE_AD_CLIENT_SECRET is set
[0;32m[PASS][0m AZURE_AD_TENANT_ID is set
[0;31m[FAIL][0m VITE_AZURE_AD_CLIENT_ID is not set
[0;31m[FAIL][0m VITE_AZURE_AD_TENANT_ID is not set

[0;35m========================================[0m
[0;35m5. Environment Variables[0m
[0;35m========================================[0m
[0;31m[FAIL][0m NODE_ENV must be 'production' (current: not set)
[0;32m[PASS][0m JWT_SECRET is set (length: 64 chars)
[1;33m[WARN][0m VITE_API_URL is not set

[0;35m========================================[0m
[0;35m6. SSL Certificates[0m
[0;35m========================================[0m
[0;32m[PASS][0m Ingress has TLS configuration
[0;32m[PASS][0m cert-manager is installed
[0;32m[PASS][0m Certificate issuers configured

[0;35m========================================[0m
[0;35m7. DNS Configuration[0m
[0;35m========================================[0m
[1;33m[WARN][0m PRODUCTION_DOMAIN not set (skipping DNS check)

[0;35m========================================[0m
[0;35m8. API Health Endpoints[0m
[0;35m========================================[0m
[0;32m[PASS][0m Health routes file exists
[1;33m[WARN][0m API not built (run: cd api && npm run build)

[0;35m========================================[0m
[0;35m9. Application Insights[0m
[0;35m========================================[0m
[1;33m[WARN][0m APPLICATION_INSIGHTS_CONNECTION_STRING not set
[0;34m[INFO][0m Application Insights provides critical monitoring for production

[0;35m========================================[0m
[0;35m10. Docker Images[0m
[0;35m========================================[0m
[0;34m[INFO][0m Checking for local Docker images...
Cannot connect to the Docker daemon at unix:///Users/andrewmorton/.docker/run/docker.sock. Is the docker daemon running?
[0;34m[INFO][0m fleet-api image not found locally (will be built during deployment)
Cannot connect to the Docker daemon at unix:///Users/andrewmorton/.docker/run/docker.sock. Is the docker daemon running?
[0;34m[INFO][0m fleet-frontend image not found locally (will be built during deployment)

[0;35m========================================[0m
[0;35m11. Kubernetes Namespace[0m
[0;35m========================================[0m
[0;32m[PASS][0m Namespace exists: fleet-management
[0;34m[INFO][0m No resource quotas configured
[0;34m[INFO][0m No network policies configured

[0;35m========================================[0m
[0;35m12. Security - Hardcoded Secrets Check[0m
[0;35m========================================[0m
[0;34m[INFO][0m Scanning for potential hardcoded secrets...
api/src/repositories/users.repository.ts:      passwordHash = 'SSO' // SSO users don't have password
api/src/scripts/seed-production-data.ts:    const passwordHash = await bcrypt.hash('Demo123!', 12);
api/src/lib/telemetry.ts:  url = url.replace(/password=([^&]+)/gi, 'password=***')
api/src/config/secrets.ts: * const secrets = await getSecrets(['db-password', 'jwt-secret', 'api-key'])
api/src/middleware/auth.ts:  const token = req.headers.authorization?.split(' ')[1] || req.cookies?.auth_token
api/src/lib/telemetry.ts:  url = url.replace(/token=([^&]+)/gi, 'token=***')
api/src/monitoring/applicationInsights.ts:    url = url.replace(/token=[^&]+/gi, 'token=***')
[0;32m[PASS][0m No obvious hardcoded secrets found

[0;35m========================================[0m
[0;35m13. Production Build Verification[0m
[0;35m========================================[0m
[0;32m[PASS][0m Frontend build directory exists
[0;32m[PASS][0m dist/index.html exists

[0;35m========================================[0m
[0;35m14. Git Status[0m
[0;35m========================================[0m
[0;34m[INFO][0m Current branch: main
[1;33m[WARN][0m Uncommitted changes detected
 M api/src/config/connection-manager.ts
 M api/src/jobs/report-scheduler.job.ts
 M api/src/middleware/cache.ts
 M api/src/middleware/rateLimiter.ts
 M api/src/ml-models/cost-forecasting.model.ts
 M api/src/ml-models/driver-scoring.model.ts
 M api/src/ml-models/fleet-optimization.model.ts
 M api/src/ml-models/fuel-price-forecasting.model.ts
 M api/src/repositories/push-notification.repository.ts
 M api/src/routes/adaptive-cards.routes.ts
[0;34m[INFO][0m No tag on current commit

[0;35m========================================[0m
[0;35mPRE-FLIGHT CHECK SUMMARY[0m
[0;35m========================================[0m

  [0;32m‚úì Passed:[0m           20
  [0;31m‚úó Failed:[0m           5
  [0;31m‚úó Critical Failed:[0m  1
  [1;33m‚ö† Warnings:[0m         6

[0;31m‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó[0m
[0;31m‚ïë  ‚úó NOT READY FOR PRODUCTION           ‚ïë[0m
[0;31m‚ïë  Critical issues must be resolved     ‚ïë[0m
[0;31m‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù[0m

Critical issues detected. Please fix the issues above before deploying.
Report saved to: preflight-report.txt
[0;31m[ERROR][0m Pre-flight checks failed
[0;34m[INFO][0m Fix issues or set SKIP_PREFLIGHT=true to override (not recommended)
[0;31m[ERROR][0m Deployment failed with exit code: 1
[0;34m[INFO][0m Check report: deployment-report-20251222-201147.txt
