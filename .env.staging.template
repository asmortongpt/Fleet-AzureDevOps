# ============================================================================
# Fleet Application - Staging Environment Configuration
# ============================================================================
# Last Updated: November 12, 2025
# Key Vault: fleet-staging-5e7dd5b7
# ============================================================================

# Environment
NODE_ENV=production
ENVIRONMENT=staging

# ============================================================================
# Azure Key Vault Configuration
# ============================================================================
# All secrets are fetched from this vault automatically
AZURE_KEY_VAULT_URI=https://fleet-staging-5e7dd5b7.vault.azure.net/

# Azure Authentication (Managed Identity in production)
AZURE_CLIENT_ID=${AZURE_CLIENT_ID}
AZURE_TENANT_ID=0ec14b81-7b82-45ee-8f3d-cbc31ced5347

# ============================================================================
# Database Configuration (Azure PostgreSQL)
# ============================================================================
# Values are fetched from Key Vault:
# - db-host: fleet-staging-db.postgres.database.azure.com
# - db-name: fleet_staging
# - db-username: fleetadmin
# - db-password: [From Key Vault]
DATABASE_HOST=${DB_HOST}
DATABASE_PORT=${DB_PORT:-5432}
DATABASE_NAME=${DB_NAME}
DATABASE_USER=${DB_USERNAME}
DATABASE_PASSWORD=${DB_PASSWORD}

# Connection Pool Settings
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=20
DATABASE_SSL_ENABLED=true

# ============================================================================
# Redis Configuration (Azure Redis Cache)
# ============================================================================
# Values are fetched from Key Vault:
# - redis-host: fleet-redis-staging.redis.cache.windows.net
# - redis-password: [From Key Vault]
REDIS_HOST=${REDIS_HOST}
REDIS_PORT=6380
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_TLS_ENABLED=true

# ============================================================================
# Application Configuration
# ============================================================================
PORT=8080
API_BASE_URL=https://fleet-staging.capitaltechalliance.com/api
FRONTEND_URL=https://fleet-staging.capitaltechalliance.com

# CORS (staging domain only)
CORS_ORIGIN=https://fleet-staging.capitaltechalliance.com

# ============================================================================
# Feature Flags (Staging)
# ============================================================================
ENABLE_DEBUG_LOGGING=true
ENABLE_HOT_RELOAD=false
ENABLE_MOCK_DATA=false
ENABLE_API_DOCS=true

# ============================================================================
# Azure Maps
# ============================================================================
AZURE_MAPS_KEY=${AZURE_MAPS_KEY}

# ============================================================================
# Azure OpenAI
# ============================================================================
AZURE_OPENAI_ENDPOINT=${AZURE_OPENAI_ENDPOINT}
AZURE_OPENAI_KEY=${AZURE_OPENAI_KEY}
AZURE_OPENAI_DEPLOYMENT=gpt-4

# ============================================================================
# Microsoft Graph API
# ============================================================================
MS_GRAPH_CLIENT_ID=${MS_GRAPH_CLIENT_ID}
MS_GRAPH_CLIENT_SECRET=${MS_GRAPH_CLIENT_SECRET}
MS_GRAPH_TENANT_ID=${MS_GRAPH_TENANT_ID}

# ============================================================================
# Azure Storage
# ============================================================================
AZURE_STORAGE_CONNECTION_STRING=${AZURE_STORAGE_CONNECTION_STRING}
AZURE_STORAGE_CONTAINER=fleet-staging

# ============================================================================
# Email Configuration (SendGrid)
# ============================================================================
SENDGRID_API_KEY=${SENDGRID_API_KEY}
SMTP_USER=${SMTP_USER}
SMTP_PASSWORD=${SMTP_PASSWORD}
EMAIL_FROM=noreply@fleet-staging.capitaltechalliance.com

# ============================================================================
# SMS Configuration (Twilio)
# ============================================================================
TWILIO_ACCOUNT_SID=${TWILIO_ACCOUNT_SID}
TWILIO_AUTH_TOKEN=${TWILIO_AUTH_TOKEN}
TWILIO_PHONE_NUMBER=${TWILIO_PHONE_NUMBER}

# ============================================================================
# Push Notifications
# ============================================================================
# Firebase (Android)
FIREBASE_SERVICE_ACCOUNT=${FIREBASE_SERVICE_ACCOUNT}

# Apple Push Notification Service (iOS)
APNS_KEY_PATH=${APNS_KEY_PATH}
APNS_KEY_ID=${APNS_KEY_ID}
APNS_TEAM_ID=${APNS_TEAM_ID}
APNS_ENVIRONMENT=sandbox

# ============================================================================
# Monitoring & Logging
# ============================================================================
LOG_LEVEL=info
ENABLE_SENTRY=true
SENTRY_DSN=${SENTRY_DSN}
SENTRY_ENVIRONMENT=staging

ENABLE_APP_INSIGHTS=true
APP_INSIGHTS_CONNECTION_STRING=${APP_INSIGHTS_CONNECTION_STRING}

# ============================================================================
# Security Settings
# ============================================================================
JWT_SECRET=${JWT_SECRET}
JWT_REFRESH_SECRET=${JWT_REFRESH_SECRET}
SESSION_SECRET=${SESSION_SECRET}
ENCRYPTION_KEY=${ENCRYPTION_KEY}
API_KEY_SALT=${API_KEY_SALT}

SESSION_DURATION=24h
JWT_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d
REQUIRE_2FA=false
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX=100

# ============================================================================
# Deployment Information
# ============================================================================
# This file is used by Azure DevOps pipeline: azure-pipelines-staging.yml
# Secrets are injected from Key Vault during deployment
# Managed Identity is used for Key Vault access in Azure App Service
