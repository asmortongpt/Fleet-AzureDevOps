# ============================================================================
# Fleet Management - Production Environment Configuration Template
# ============================================================================
#
# SECURITY INSTRUCTIONS:
# 1. Copy this file to .env.production
# 2. Replace ALL placeholder values with actual production credentials
# 3. NEVER commit .env.production to Git
# 4. Store production secrets in Azure Key Vault when possible
# 5. Rotate all secrets every 90 days
#
# ============================================================================

# ============================================================================
# Environment
# ============================================================================
NODE_ENV=production

# ============================================================================
# Server Configuration
# ============================================================================
PORT=3000
API_BASE_URL=https://api.fleetmanagement.com

# ============================================================================
# CORS Configuration
# ============================================================================
# Production frontend URLs (comma-separated, no wildcards)
CORS_ORIGIN=https://app.fleetmanagement.com,https://portal.fleetmanagement.com

# ============================================================================
# Database Configuration
# ============================================================================
# Azure PostgreSQL Connection String
DATABASE_URL=postgresql://USERNAME:PASSWORD@SERVER.postgres.database.azure.com:5432/fleet_production?ssl=true&sslmode=require

# Database Connection Pool Settings
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_IDLE_TIMEOUT_MS=30000
DB_CONNECTION_TIMEOUT_MS=5000
DB_EAGER_INIT=true
DB_MONITOR_ENABLED=true

# ============================================================================
# Security - CRITICAL: Generate strong secrets
# Generate with: openssl rand -base64 48
# ============================================================================
CSRF_SECRET=REPLACE_WITH_PRODUCTION_CSRF_SECRET_MIN_64_CHARS
JWT_SECRET=REPLACE_WITH_PRODUCTION_JWT_SECRET_MIN_64_CHARS
SESSION_SECRET=REPLACE_WITH_PRODUCTION_SESSION_SECRET_MIN_64_CHARS

# JWT Configuration
JWT_EXPIRES_IN=7d

# ============================================================================
# Azure AD Authentication (Production)
# ============================================================================
AZURE_AD_CLIENT_ID=your-production-azure-ad-client-id
AZURE_AD_TENANT_ID=your-production-azure-ad-tenant-id
AZURE_AD_CLIENT_SECRET=your-production-azure-ad-client-secret
AZURE_AD_REDIRECT_URI=https://app.fleetmanagement.com/auth/callback

# ============================================================================
# Microsoft Graph API
# ============================================================================
MICROSOFT_GRAPH_API_ENDPOINT=https://graph.microsoft.com/v1.0

# ============================================================================
# Azure Blob Storage (Production)
# ============================================================================
AZURE_STORAGE_ACCOUNT=your_production_storage_account
AZURE_STORAGE_KEY=your_production_storage_key
AZURE_STORAGE_CONTAINER=asset-photos-prod
AZURE_STORAGE_ACCOUNT_NAME=your_production_storage_account
AZURE_STORAGE_ACCOUNT_KEY=your_production_storage_key
AZURE_STORAGE_CONTAINER_NAME=fleet-documents-prod

# ============================================================================
# Redis (Production - Azure Cache for Redis)
# ============================================================================
REDIS_URL=rediss://YOUR_REDIS_HOST.redis.cache.windows.net:6380?password=YOUR_REDIS_KEY
REDIS_HOST=YOUR_REDIS_HOST.redis.cache.windows.net
REDIS_PORT=6380
REDIS_PASSWORD=YOUR_REDIS_KEY
REDIS_DB=0
REDIS_TLS=true

# ============================================================================
# Azure Container Registry (for deployment)
# ============================================================================
AZURE_CONTAINER_REGISTRY=your_acr_name
AZURE_RESOURCE_GROUP=your-production-resource-group
API_IMAGE_NAME=fleet-api

# ============================================================================
# Azure Application Insights (Monitoring)
# ============================================================================
APPINSIGHTS_INSTRUMENTATIONKEY=your-production-instrumentation-key

# ============================================================================
# AI Services - Production Keys
# ============================================================================

# Azure OpenAI (Primary AI Provider)
AZURE_OPENAI_ENDPOINT=https://YOUR-PRODUCTION-RESOURCE.openai.azure.com/
AZURE_OPENAI_KEY=YOUR_PRODUCTION_AZURE_OPENAI_KEY
AZURE_OPENAI_DEPLOYMENT=gpt-4
AZURE_OPENAI_API_VERSION=2024-02-15-preview

# Anthropic Claude API
ANTHROPIC_API_KEY=your-production-anthropic-key

# OpenAI (Fallback)
OPENAI_API_KEY=your-production-openai-key

# Azure Computer Vision (OCR Service)
AZURE_COMPUTER_VISION_ENDPOINT=https://YOUR-REGION.api.cognitive.microsoft.com/
AZURE_COMPUTER_VISION_KEY=YOUR_PRODUCTION_COMPUTER_VISION_KEY

# ============================================================================
# Third-Party Integrations (Production)
# ============================================================================

# Google Maps API
GOOGLE_MAPS_API_KEY=your-production-google-maps-key

# SmartCar API
SMARTCAR_CLIENT_ID=your-production-smartcar-client-id
SMARTCAR_CLIENT_SECRET=your-production-smartcar-client-secret
SMARTCAR_REDIRECT_URI=https://api.fleetmanagement.com/api/smartcar/callback

# ============================================================================
# Email Configuration (Production SMTP)
# ============================================================================
EMAIL_HOST=smtp.office365.com
EMAIL_PORT=587
EMAIL_USER=notifications@fleetmanagement.com
EMAIL_PASSWORD=your-production-email-password
EMAIL_FROM=noreply@fleetmanagement.com
EMAIL_USE_TLS=true

# ============================================================================
# Feature Flags (Production)
# ============================================================================
ENABLE_AI_FEATURES=true
ENABLE_VIDEO_TELEMATICS=true
ENABLE_EV_MANAGEMENT=true
ENABLE_DOCUMENT_OCR=true
ENABLE_3D_MODELS=true
ENABLE_TELEMETRY=true
ENABLE_WEBHOOKS=true
ENABLE_ML_FEATURES=true

# ============================================================================
# Background Jobs & Workers (Production)
# ============================================================================
ENABLE_MAINTENANCE_SCHEDULER=true
ENABLE_TELEMATICS_SYNC=true
ENABLE_TEAMS_SYNC=true
ENABLE_OUTLOOK_SYNC=true

# Job Intervals (in milliseconds)
MAINTENANCE_CHECK_INTERVAL=1800000  # 30 minutes
TELEMATICS_SYNC_INTERVAL=300000     # 5 minutes

# ============================================================================
# Rate Limiting (Production - Stricter)
# ============================================================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
GLOBAL_RATE_LIMIT=100  # Requests per minute

# ============================================================================
# Security Headers & Compliance
# ============================================================================
ENFORCE_FIPS=true
STRICT_TRANSPORT_SECURITY_MAX_AGE=31536000

# ============================================================================
# WebSocket Configuration (Production)
# ============================================================================
WEBSOCKET_PATH=/socket.io
WEBSOCKET_PING_INTERVAL=25000
WEBSOCKET_PING_TIMEOUT=60000

# ============================================================================
# Logging (Production)
# ============================================================================
LOG_LEVEL=warn

# ============================================================================
# Graceful Shutdown
# ============================================================================
SHUTDOWN_TIMEOUT_MS=30000

# ============================================================================
# CRITICAL SECURITY SETTINGS
# ============================================================================

# NEVER enable mock data in production
USE_MOCK_DATA=false

# Content Safety (Enable in production)
ENABLE_CONTENT_SAFETY=true
AZURE_CONTENT_SAFETY_ENDPOINT=https://YOUR-REGION.api.cognitive.microsoft.com/
AZURE_CONTENT_SAFETY_KEY=YOUR_PRODUCTION_CONTENT_SAFETY_KEY

# ============================================================================
# Azure Key Vault (RECOMMENDED for Production)
# ============================================================================
# Uncomment and use Azure Key Vault for secret management
# AZURE_KEY_VAULT_URL=https://your-production-keyvault.vault.azure.net
# USE_AZURE_KEY_VAULT=true

# ============================================================================
# Deployment Configuration
# ============================================================================
API_ENDPOINT=https://api.fleetmanagement.com
AZURE_STATIC_WEB_APP_URL=https://app.fleetmanagement.com

# ============================================================================
# PRODUCTION CHECKLIST
# ============================================================================
# Before deploying to production, ensure:
#
# [ ] All placeholders replaced with actual production values
# [ ] Secrets generated with: openssl rand -base64 48
# [ ] Different secrets than dev/staging environments
# [ ] Azure Key Vault configured (recommended)
# [ ] Database SSL/TLS enabled
# [ ] Redis TLS enabled
# [ ] CORS origins restricted to production domains only
# [ ] USE_MOCK_DATA is false
# [ ] ENFORCE_FIPS is true (for compliance)
# [ ] LOG_LEVEL set to 'warn' or 'error'
# [ ] Rate limits configured appropriately
# [ ] Application Insights configured
# [ ] Backup and disaster recovery plan in place
# [ ] Security audit completed
# [ ] Secrets rotation schedule established
#
# ============================================================================
