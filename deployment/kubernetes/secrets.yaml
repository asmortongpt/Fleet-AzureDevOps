# WARNING: DO NOT store secrets directly in this file!
# This file is a TEMPLATE ONLY and should not be used as-is in production.
#
# SECURITY BEST PRACTICES:
# 1. Use Azure Key Vault with External Secrets Operator (recommended for production)
#    - Run: /home/user/Fleet/scripts/setup-azure-keyvault.sh
#    - Then apply: /home/user/Fleet/deployment/secure/external-secrets-setup.yaml
#
# 2. OR create secrets using kubectl with values from environment variables:
#    kubectl create secret generic fleet-secrets \
#      --from-literal=DB_USERNAME="${DB_USERNAME}" \
#      --from-literal=DB_PASSWORD="${DB_PASSWORD}" \
#      --from-literal=REDIS_PASSWORD="${REDIS_PASSWORD}" \
#      --from-literal=JWT_SECRET="${JWT_SECRET}" \
#      --from-literal=ENCRYPTION_KEY="${ENCRYPTION_KEY}" \
#      --from-literal=AZURE_STORAGE_CONNECTION_STRING="${AZURE_STORAGE_CONNECTION_STRING}" \
#      -n fleet-management
#
# 3. OR use sealed-secrets / sops for encrypted secrets in Git
#
# DO NOT commit actual secrets to version control!

---
# Example Secret Template (DO NOT USE IN PRODUCTION)
# apiVersion: v1
# kind: Secret
# metadata:
#   name: fleet-secrets
#   namespace: fleet-management
# type: Opaque
# stringData:
#   DB_USERNAME: "USE_EXTERNAL_SECRETS_OPERATOR"
#   DB_PASSWORD: "USE_EXTERNAL_SECRETS_OPERATOR"
#   REDIS_PASSWORD: "USE_EXTERNAL_SECRETS_OPERATOR"
#   JWT_SECRET: "USE_EXTERNAL_SECRETS_OPERATOR"
#   JWT_REFRESH_SECRET: "USE_EXTERNAL_SECRETS_OPERATOR"
#   ENCRYPTION_KEY: "USE_EXTERNAL_SECRETS_OPERATOR"
#   ENCRYPTION_IV: "USE_EXTERNAL_SECRETS_OPERATOR"
#   SMARTCAR_CLIENT_ID: "USE_EXTERNAL_SECRETS_OPERATOR"
#   SMARTCAR_CLIENT_SECRET: "USE_EXTERNAL_SECRETS_OPERATOR"
#   MICROSOFT_GRAPH_CLIENT_ID: "USE_EXTERNAL_SECRETS_OPERATOR"
#   MICROSOFT_GRAPH_CLIENT_SECRET: "USE_EXTERNAL_SECRETS_OPERATOR"
#   AZURE_STORAGE_CONNECTION_STRING: "USE_EXTERNAL_SECRETS_OPERATOR"
#   EMAIL_SERVICE_API_KEY: "USE_EXTERNAL_SECRETS_OPERATOR"
#   TWILIO_AUTH_TOKEN: "USE_EXTERNAL_SECRETS_OPERATOR"
#   DATADOG_API_KEY: "USE_EXTERNAL_SECRETS_OPERATOR"
#   SENTRY_DSN: "USE_EXTERNAL_SECRETS_OPERATOR"
  
---
# Azure Key Vault Secret Provider Class (Recommended for Production)
# This is a TEMPLATE - Update values after running setup-azure-keyvault.sh
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: fleet-azure-keyvault
  namespace: fleet-management
spec:
  provider: azure
  parameters:
    usePodIdentity: "false"
    useVMManagedIdentity: "true"
    # Update this after running setup-azure-keyvault.sh
    userAssignedIdentityID: ""
    # Update with your Key Vault name from setup-azure-keyvault.sh output
    keyvaultName: "fleet-keyvault"
    cloudName: ""
    objects: |
      array:
        - |
          objectName: db-password
          objectType: secret
          objectVersion: ""
        - |
          objectName: jwt-secret
          objectType: secret
          objectVersion: ""
        - |
          objectName: encryption-key
          objectType: secret
          objectVersion: ""
        - |
          objectName: openai-api-key
          objectType: secret
          objectVersion: ""
        - |
          objectName: claude-api-key
          objectType: secret
          objectVersion: ""
        - |
          objectName: azure-storage-connection-string
          objectType: secret
          objectVersion: ""
    # Get tenant ID from: az account show --query tenantId -o tsv
    tenantId: ""
  secretObjects:
    - secretName: fleet-keyvault-secrets
      type: Opaque
      data:
        - objectName: db-password
          key: DB_PASSWORD
        - objectName: jwt-secret
          key: JWT_SECRET
        - objectName: encryption-key
          key: ENCRYPTION_KEY
        - objectName: openai-api-key
          key: OPENAI_API_KEY
        - objectName: claude-api-key
          key: CLAUDE_API_KEY
        - objectName: azure-storage-connection-string
          key: AZURE_STORAGE_CONNECTION_STRING
