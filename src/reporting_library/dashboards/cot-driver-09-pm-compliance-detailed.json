{
  "id": "cot-driver-09",
  "title": "PM Compliance (Detailed)",
  "domain": "pm",
  "category": "city_tallahassee_driver",
  "description": "Detailed PM compliance breakdown",
  "datasource": {"type": "sqlView", "view": "vw_pm_compliance_detailed", "parameters": {"month": "{{month}}", "shop": "{{shop}}"}},
  "filters": [{"name": "month", "type": "month", "default": "current_month", "required": true}, {"name": "shop", "type": "multiSelect", "values": "dynamic", "default": "All"}],
  "visuals": [
    {"id": "kpis", "type": "kpiTiles", "title": "PM Detailed Summary", "measures": [{"id": "compliance_rate", "label": "Compliance Rate", "format": "percent", "expression": "pm_completed_count/pm_due_count"}], "layout": {"x": 0, "y": 0, "w": 12, "h": 2}},
    {"id": "pm_detail_table", "type": "table", "title": "PM Detail", "columns": [{"field": "equipment_key", "label": "Equipment"}, {"field": "pm_task", "label": "PM Task"}, {"field": "due_date", "label": "Due Date"}, {"field": "completed_date", "label": "Completed"}, {"field": "status", "label": "Status"}], "pagination": {"pageSize": 50}, "layout": {"x": 0, "y": 2, "w": 12, "h": 6}}
  ],
  "exports": [{"format": "csv"}, {"format": "xlsx"}, {"format": "pdf"}],
  "security": {"rowLevel": [{"role": "ShopManager", "rule": "shop_name IN user.shops"}, {"role": "Admin", "rule": "TRUE"}]}
}
